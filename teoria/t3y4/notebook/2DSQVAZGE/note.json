{
  "paragraphs": [
    {
      "text": "%md\n## Introducción a los DataFrames\nEn este tema veremos:\n\n  - Como crear un DataFrames\n  - Alguna operaciones básicas sobre DataFrames\n      - Mostrar filas\n      - Seleccionar columnas\n      - Renombrar, añadir y eliminar columnas\n      - Eliminar valores nulos y filas duplicadas\n      - Reemplazar valores\n  - Guardar los DataFrames en diferentes formatos ",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:49:50.918",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eIntroducción a los DataFrames\u003c/h2\u003e\n\u003cp\u003eEn este tema veremos:\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eComo crear un DataFrames\u003c/li\u003e\n  \u003cli\u003eAlguna operaciones básicas sobre DataFrames\n    \u003cul\u003e\n      \u003cli\u003eMostrar filas\u003c/li\u003e\n      \u003cli\u003eSeleccionar columnas\u003c/li\u003e\n      \u003cli\u003eRenombrar, añadir y eliminar columnas\u003c/li\u003e\n      \u003cli\u003eEliminar valores nulos y filas duplicadas\u003c/li\u003e\n      \u003cli\u003eReemplazar valores\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003eGuardar los DataFrames en diferentes formatos\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539191997614_1158393325",
      "id": "20181010-171957_1738445643",
      "dateCreated": "2018-10-10 17:19:57.000",
      "dateStarted": "2018-11-09 11:34:34.000",
      "dateFinished": "2018-11-09 11:34:34.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Creación de DataFrames\nUn DataFrame puede crearse de distintas formas:\n\n  - A partir de una secuencia de datos\n  - A partir de objetos de tipo Row\n  - A partir de un RDD o DataSet\n  - Leyendo los datos de un fichero\n      - Igual que Hadoop, Spark soporta diferentes filesystems: local, HDFS, Amazon S3\n          - En general, soporta cualquier fuente de datos que se pueda leer con Hadoop\n      - Spark puede acceder a diferentes tipos de ficheros: texto plano, CSV, JSON, [Parquet](https://parquet.apache.org/), [ORC](https://orc.apache.org/), Sequence, etc\n        -   Soporta ficheros comprimidos\n  - Accediendo a bases de datos relacionales o noSQL\n    -   MySQL, Postgres, etc. mediante JDBC/ODBC\n    -   Hive, HBase, Cassandra, MongoDB, AWS Redshift, etc.",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:49:50.918",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eCreación de DataFrames\u003c/h1\u003e\n\u003cp\u003eUn DataFrame puede crearse de distintas formas:\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eA partir de una secuencia de datos\u003c/li\u003e\n  \u003cli\u003eA partir de objetos de tipo Row\u003c/li\u003e\n  \u003cli\u003eA partir de un RDD o DataSet\u003c/li\u003e\n  \u003cli\u003eLeyendo los datos de un fichero\n    \u003cul\u003e\n      \u003cli\u003eIgual que Hadoop, Spark soporta diferentes filesystems: local, HDFS, Amazon S3\n        \u003cul\u003e\n          \u003cli\u003eEn general, soporta cualquier fuente de datos que se pueda leer con Hadoop\u003c/li\u003e\n        \u003c/ul\u003e\n      \u003c/li\u003e\n      \u003cli\u003eSpark puede acceder a diferentes tipos de ficheros: texto plano, CSV, JSON, \u003ca href\u003d\"https://parquet.apache.org/\"\u003eParquet\u003c/a\u003e, \u003ca href\u003d\"https://orc.apache.org/\"\u003eORC\u003c/a\u003e, Sequence, etc\n        \u003cul\u003e\n          \u003cli\u003eSoporta ficheros comprimidos\u003c/li\u003e\n        \u003c/ul\u003e\n      \u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003eAccediendo a bases de datos relacionales o noSQL\n    \u003cul\u003e\n      \u003cli\u003eMySQL, Postgres, etc. mediante JDBC/ODBC\u003c/li\u003e\n      \u003cli\u003eHive, HBase, Cassandra, MongoDB, AWS Redshift, etc.\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539250213006_274041515",
      "id": "20181011-093013_939373414",
      "dateCreated": "2018-10-11 09:30:13.000",
      "dateStarted": "2018-11-07 08:49:00.000",
      "dateFinished": "2018-11-07 08:49:00.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Creando DataFrames a partir de una secuencia o lista de datos",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:49:50.918",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eCreando DataFrames a partir de una secuencia o lista de datos\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539250262608_-923509300",
      "id": "20181011-093102_2053383267",
      "dateCreated": "2018-10-11 09:31:02.000",
      "dateStarted": "2018-10-11 10:10:47.000",
      "dateFinished": "2018-10-11 10:10:47.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.functions import col,expr\n# Creando un DataFrame desde un rango y añadiendole dos columna\ndf \u003d spark.range(1,7,2).toDF(\"n\")\ndf.show()\nn \u003d col(\"n\")\ndf.withColumn(\"n1\", n+1).withColumn(\"n2\", expr(\"2*n1\")).show()\n# En la llamada a expr se puede indicar código SQL",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:00:52.265",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---+\n|  n|\n+---+\n|  1|\n|  3|\n|  5|\n+---+\n\n+---+---+---+\n|  n| n1| n2|\n+---+---+---+\n|  1|  2|  4|\n|  3|  4|  8|\n|  5|  6| 12|\n+---+---+---+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539250571278_-544185546",
      "id": "20181011-093611_1482695093",
      "dateCreated": "2018-10-11 09:36:11.000",
      "dateStarted": "2020-11-16 16:00:52.322",
      "dateFinished": "2020-11-16 16:00:52.532",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n\n// Creando un DataFrame desde un rango y añadiendole una columna\nval df \u003d spark.range(1,7,2).toDF(\"n\")\ndf.show\ndf.withColumn(\"n1\", col(\"n\")+1).withColumn(\"n2\", expr(\"2*n\")).show\n// En la llamada a expr se puede indicar código SQL",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:17.475",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539250957484_40001584",
      "id": "20181011-094237_1060207916",
      "dateCreated": "2018-10-11 09:42:37.000",
      "dateStarted": "2020-06-15 17:50:18.115",
      "dateFinished": "2020-06-15 17:50:19.678",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# DataFrame a partir de una lista de tuplas\nl \u003d [(\"Pepe\", 5.1, \"Aprobado\"),\\\n     (\"Juan\", 4.0, \"Suspenso\"),\\\n     (\"Manuel\", None, None)]\ndfNotas \u003d spark.createDataFrame(l, schema\u003d[\"Nombre\", \"nota\", \"cal\"])\ndfNotas.show()\ndfNotas.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:02:16.661",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+----+--------+\n|Nombre|nota|     cal|\n+------+----+--------+\n|  Pepe| 5.1|Aprobado|\n|  Juan| 4.0|Suspenso|\n|Manuel|null|    null|\n+------+----+--------+\n\nroot\n |-- Nombre: string (nullable \u003d true)\n |-- nota: double (nullable \u003d true)\n |-- cal: string (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539251722760_188962191",
      "id": "20181011-095522_2112387600",
      "dateCreated": "2018-10-11 09:55:22.000",
      "dateStarted": "2020-11-16 16:02:16.727",
      "dateFinished": "2020-11-16 16:02:17.659",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n// DataFrame a partir de una lista de tuplas\n// Esta forma de crear el DataFrame a partir de Seq no soporta nulls\nval dfNotas \u003d Seq((\"Pepe\", 5.1F, \"Aprobado\"), \n                  (\"Juan\", 4.0F, \"Suspenso\"), \n                  (\"Manuel\", 8.3F, \"Notable\")).\n                  toDF(\"Nombre\", \"nota\", \"cal\")\ndfNotas.show()\ndfNotas.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:21.984",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539252480673_-734078976",
      "id": "20181011-100800_1141439264",
      "dateCreated": "2018-10-11 10:08:00.000",
      "dateStarted": "2020-06-15 17:50:22.391",
      "dateFinished": "2020-06-15 17:50:23.903",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Creando DataFrames con esquema\nA la hora de crear un DataFrame, es conveniente especificar el esquema del mismo:\n\n  - El esquema define los nombres y tipos de datos de las columnas\n  - Se usa un objeto de tipo ``StructType`` para definir el nombre y tipo de las columnas, mediante \n  - Los tipos de datos que utiliza Spark están definidos en:\n      - Para PySpark: http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.types\n      - Para Scala: https://spark.apache.org/docs/latest/api/scala/#org.apache.spark.sql.types.package\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:23.991",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eCreando DataFrames con esquema\u003c/h2\u003e\n\u003cp\u003eA la hora de crear un DataFrame, es conveniente especificar el esquema del mismo:\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eEl esquema define los nombres y tipos de datos de las columnas\u003c/li\u003e\n  \u003cli\u003eSe usa un objeto de tipo \u003ccode\u003eStructType\u003c/code\u003e para definir el nombre y tipo de las columnas, mediante\u003c/li\u003e\n  \u003cli\u003eLos tipos de datos que utiliza Spark están definidos en:\n    \u003cul\u003e\n      \u003cli\u003ePara PySpark: \u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.types\"\u003ehttp://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.types\u003c/a\u003e\u003c/li\u003e\n      \u003cli\u003ePara Scala: \u003ca href\u003d\"https://spark.apache.org/docs/latest/api/scala/#org.apache.spark.sql.types.package\"\u003ehttps://spark.apache.org/docs/latest/api/scala/#org.apache.spark.sql.types.package\u003c/a\u003e\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539259411223_-1718648454",
      "id": "20181011-120331_51198615",
      "dateCreated": "2018-10-11 12:03:31.000",
      "dateStarted": "2018-10-11 12:39:15.000",
      "dateFinished": "2018-10-11 12:39:15.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.types import StructField, StructType, FloatType, StringType\nfrom pyspark.sql import Row\n# Definimos el esquema del DataFrame\nesquemaNotas \u003d StructType([\n    StructField(\"Nombre\", StringType(), False),\n    StructField(\"nota\", FloatType(), True),\n    StructField(\"cal\", StringType(), True)\n    ])\n    \n# Creamos el DataFrame a partir de una lista de objetos Row\nfilas \u003d [Row(\"Pepe\", 5.1, \"Aprobado\"),\\\n         Row(\"Juan\", 4.0, \"Suspenso\"),\\\n         Row(\"Manuel\", None, None)]\n\ndfNotas \u003d spark.createDataFrame(filas, schema\u003desquemaNotas)\ndfNotas.show()\ndfNotas.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:05:38.730",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+----+--------+\n|Nombre|nota|     cal|\n+------+----+--------+\n|  Pepe| 5.1|Aprobado|\n|  Juan| 4.0|Suspenso|\n|Manuel|null|    null|\n+------+----+--------+\n\nroot\n |-- Nombre: string (nullable \u003d false)\n |-- nota: float (nullable \u003d true)\n |-- cal: string (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539259452855_-1355635725",
      "id": "20181011-120412_1494192530",
      "dateCreated": "2018-10-11 12:04:12.000",
      "dateStarted": "2020-11-16 16:05:28.136",
      "dateFinished": "2020-11-16 16:05:28.338",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nimport org.apache.spark.sql.types.{StructField, StructType, FloatType, StringType}\nimport org.apache.spark.sql.Row\n\nval esquemaNotas \u003d new StructType(Array(\n    new StructField(\"Nombre\", StringType, false),\n    new StructField(\"nota\", FloatType, true),\n    new StructField(\"cal\", StringType, true)\n    ))\n\nval filas \u003d Seq(Row(\"Pepe\", 5.1F, \"Aprobado\"),\n                Row(\"Juan\", 4.0F, \"Suspenso\"),\n                Row(\"Manuel\", null, null))\n\nval rddNotas \u003d spark.sparkContext.parallelize(filas)\nval notasDF \u003d spark.createDataFrame(rddNotas, esquemaNotas)\nnotasDF.show\nnotasDF.printSchema",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:25.122",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539260226233_-996234299",
      "id": "20181011-121706_931656717",
      "dateCreated": "2018-10-11 12:17:06.000",
      "dateStarted": "2020-06-15 17:50:25.577",
      "dateFinished": "2020-06-15 17:50:26.752",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Creando DataFrames a partir de un fichero de texto\n\nCada línea del fichero se guarda como una fila",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:26.787",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eCreando DataFrames a partir de un fichero de texto\u003c/h2\u003e\n\u003cp\u003eCada línea del fichero se guarda como una fila\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541534645705_612706883",
      "id": "20181106-200405_1654063285",
      "dateCreated": "2018-11-06 20:04:05.000",
      "dateStarted": "2018-11-07 08:50:25.000",
      "dateFinished": "2018-11-07 08:50:25.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval dfQuijote \u003d spark.read.textFile(\"/datos/quijote.txt\")\ndfQuijote.show(50, truncate\u003dfalse)",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:06:11.786",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------------------------------------------------------------------------+\n|value                                                                      |\n+---------------------------------------------------------------------------+\n|The Project Gutenberg EBook of Don Quijote, by Miguel de Cervantes Saavedra|\n|                                                                           |\n|This eBook is for the use of anyone anywhere at no cost and with           |\n|almost no restrictions whatsoever.  You may copy it, give it away or       |\n|re-use it under the terms of the Project Gutenberg License included        |\n|with this eBook or online at www.gutenberg.net                             |\n|                                                                           |\n|                                                                           |\n|Title: Don Quijote                                                         |\n|                                                                           |\n|Author: Miguel de Cervantes Saavedra                                       |\n|                                                                           |\n|Posting Date: April 27, 2010 [EBook #2000]                                 |\n|Release Date: December, 1999                                               |\n|                                                                           |\n|Language: Spanish                                                          |\n|                                                                           |\n|                                                                           |\n|*** START OF THIS PROJECT GUTENBERG EBOOK DON QUIJOTE ***                  |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|Produced by an anonymous Project Gutenberg volunteer. Text                 |\n|file corrections and new HTML file by Joaquin Cuenca Abela.                |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|                                                                           |\n|El ingenioso hidalgo don Quijote de la Mancha                              |\n|                                                                           |\n|                                                                           |\n|TASA                                                                       |\n|                                                                           |\n|Yo, Juan Gallo de Andrada, escribano de Cámara del Rey nuestro señor, de   |\n|los que residen en su Consejo, certifico y doy fe que, habiendo visto por  |\n|los señores dél un libro intitulado El ingenioso hidalgo de la Mancha,     |\n|compuesto por Miguel de Cervantes Saavedra, tasaron cada pliego del dicho  |\n|libro a tres maravedís y medio; el cual tiene ochenta y tres pliegos, que  |\n|al dicho precio monta el dicho libro docientos y noventa maravedís y medio,|\n|en que se ha de vender en papel; y dieron licencia para que a este precio  |\n|se pueda vender, y mandaron que esta tasa se ponga al principio del dicho  |\n|libro, y no se pueda vender sin ella. Y, para que dello conste, di la      |\n+---------------------------------------------------------------------------+\nonly showing top 50 rows\n\ndfQuijote: org.apache.spark.sql.Dataset[String] \u003d [value: string]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541534670697_88857572",
      "id": "20181106-200430_1640854561",
      "dateCreated": "2018-11-06 20:04:30.000",
      "dateStarted": "2020-11-16 16:06:11.846",
      "dateFinished": "2020-11-16 16:06:12.182",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Creando DataFrames a partir de un fichero CSV\n\nComo ejemplo vamos a utilizar un fichero con preguntas y respuestas de Stack Exchange (https://stackexchange.com/) en italiano. Es un fichero CVS, con 13 campos que son:\n\n  0. ``nComs`` - Número de comentarios de la pregunta o respuesta\n  2. ``ultimaActividad`` - Fecha y hora de la última modificación\n  3. ``userId`` - ID del propietario\n  4. ``cuerpo`` - Texto de la pregunta o respuesta\n  5. ``puntos`` - Puntuación de la pregunta o respuesta basada en votos positivos y negativos\n  6. ``fechaCreacion`` - Fecha y hora de creación\n  6. ``numVistas`` - Número de vistas (null si la pregunta no tiene vistas)\n  7. ``titulo`` - Título de la pregunta (null si es una respuesta)\n  8. ``tags`` - Etiquetas asignadas a la pregunta (null si no tiene)\n  9. ``nRespuestas`` - Número de respuestas relacionadas con la pregunta (null si no tiene)\n  10. ``respAceptadaId`` - El ID de la respuesta aceptada (null si la pregunta no tiene respuesta aceptada)\n  11. ``tipoPost`` - Tipo del mensaje: 1 pregunta, 2 respuesta\n  12. ``id`` - Identificador único del mensaje\n\nLos campos se encuentran separados por el símbolo \"~\"",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:28.171",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eCreando DataFrames a partir de un fichero CSV\u003c/h2\u003e\n\u003cp\u003eComo ejemplo vamos a utilizar un fichero con preguntas y respuestas de Stack Exchange (\u003ca href\u003d\"https://stackexchange.com/\"\u003ehttps://stackexchange.com/\u003c/a\u003e) en italiano. Es un fichero CVS, con 13 campos que son:\u003c/p\u003e\n\u003col\u003e\n  \u003cli\u003e\u003ccode\u003enComs\u003c/code\u003e - Número de comentarios de la pregunta o respuesta\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003eultimaActividad\u003c/code\u003e - Fecha y hora de la última modificación\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003euserId\u003c/code\u003e - ID del propietario\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003ecuerpo\u003c/code\u003e - Texto de la pregunta o respuesta\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003epuntos\u003c/code\u003e - Puntuación de la pregunta o respuesta basada en votos positivos y negativos\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003efechaCreacion\u003c/code\u003e - Fecha y hora de creación\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003enumVistas\u003c/code\u003e - Número de vistas (null si la pregunta no tiene vistas)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003etitulo\u003c/code\u003e - Título de la pregunta (null si es una respuesta)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003etags\u003c/code\u003e - Etiquetas asignadas a la pregunta (null si no tiene)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003enRespuestas\u003c/code\u003e - Número de respuestas relacionadas con la pregunta (null si no tiene)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003erespAceptadaId\u003c/code\u003e - El ID de la respuesta aceptada (null si la pregunta no tiene respuesta aceptada)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003etipoPost\u003c/code\u003e - Tipo del mensaje: 1 pregunta, 2 respuesta\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003eid\u003c/code\u003e - Identificador único del mensaje\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eLos campos se encuentran separados por el símbolo \u0026ldquo;~\u0026rdquo;\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539018352056_-1368415332",
      "id": "20181008-170552_1081126929",
      "dateCreated": "2018-10-08 17:05:52.000",
      "dateStarted": "2020-06-15 17:50:28.532",
      "dateFinished": "2020-06-15 17:50:31.289",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Leemos el fichero infiriendo el esquema",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:31.343",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eLeemos el fichero infiriendo el esquema\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539075391047_1633111056",
      "id": "20181009-085631_382788171",
      "dateCreated": "2018-10-09 08:56:31.000",
      "dateStarted": "2018-10-09 09:58:24.000",
      "dateFinished": "2018-10-09 09:58:24.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\nls /datos\n",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:09:42.693",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "2015-summary.csv\nby-day\nitalianPosts.csv.bz2\nquijote.txt\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1605542953489_1272863659",
      "id": "20201116-160913_828793009",
      "dateCreated": "2020-11-16 16:09:13.489",
      "dateStarted": "2020-11-16 16:09:42.743",
      "dateFinished": "2020-11-16 16:09:42.761",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\ndfSEInfered \u003d spark.read.format(\"csv\")\\\n                    .option(\"mode\", \"FAILFAST\")\\\n                    .option(\"sep\", \"~\")\\\n                    .option(\"inferSchema\", \"true\")\\\n                    .option(\"header\", \"false\")\\\n                    .option(\"nullValue\", \"null\")\\\n                    .option(\"compression\", \"bzip2\")\\\n                    .load(\"/datos/italianPosts.csv.bz2\")",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:11:27.727",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1539018533419_-2055475548",
      "id": "20181008-170853_1181066191",
      "dateCreated": "2018-10-08 17:08:53.000",
      "dateStarted": "2020-11-16 16:11:27.790",
      "dateFinished": "2020-11-16 16:11:28.497",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nval dfSEInfered \u003d spark.read.format(\"csv\").\n                    option(\"mode\", \"FAILFAST\").\n                    option(\"sep\", \"~\").\n                    option(\"inferSchema\", \"true\").\n                    option(\"header\", \"false\").\n                    option(\"nullValue\", \"null\").\n                    option(\"compression\", \"bzip2\").\n                    load(\"/datos/italianPosts.csv.bz2\")",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:11:34.383",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "dfSEInfered: org.apache.spark.sql.DataFrame \u003d [_c0: int, _c1: timestamp ... 11 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539077910107_1515909069",
      "id": "20181009-093830_1425962770",
      "dateCreated": "2018-10-09 09:38:30.000",
      "dateStarted": "2020-11-16 16:11:34.442",
      "dateFinished": "2020-11-16 16:11:34.995",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nAlgunas opciones:\n\n1. ``mode``: especifica qué hacer cuando se encuentra registros corruptos\n    - ``PERMISSIVE``: pone todos los campos a null cuando se encuentra un registro corrupto (valor por defecto)\n    - ``DROPMALFORMED``: elimina las filas con registros corruptos\n    - ``FAILFAST``: da un error cuando se encuentra un registro corrupto\n2. ``sep``: separador entre campos (por defecto \",\")\n3. ``inferSchema``: especifica si se deben inferir el tipo de las columnas (por defecto \"false\")\n4. ``header``: si \"true\" se toma la primera fila como cabecera (por defecto \"false\")\n5. ``nullValue``: carrácter o cadena que representa un NULL en el fichero (por defecto \"\")\n6. ``compression``: topo de compresión utilizada (por defecto \"none\")\n  \nLas opciones son similares para otros tipos de ficheros.",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:34.602",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eAlgunas opciones:\u003c/p\u003e\n\u003col\u003e\n  \u003cli\u003e\u003ccode\u003emode\u003c/code\u003e: especifica qué hacer cuando se encuentra registros corruptos\n    \u003cul\u003e\n      \u003cli\u003e\u003ccode\u003ePERMISSIVE\u003c/code\u003e: pone todos los campos a null cuando se encuentra un registro corrupto (valor por defecto)\u003c/li\u003e\n      \u003cli\u003e\u003ccode\u003eDROPMALFORMED\u003c/code\u003e: elimina las filas con registros corruptos\u003c/li\u003e\n      \u003cli\u003e\u003ccode\u003eFAILFAST\u003c/code\u003e: da un error cuando se encuentra un registro corrupto\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003esep\u003c/code\u003e: separador entre campos (por defecto \u0026ldquo;,\u0026rdquo;)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003einferSchema\u003c/code\u003e: especifica si se deben inferir el tipo de las columnas (por defecto \u0026ldquo;false\u0026rdquo;)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003eheader\u003c/code\u003e: si \u0026ldquo;true\u0026rdquo; se toma la primera fila como cabecera (por defecto \u0026ldquo;false\u0026rdquo;)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003enullValue\u003c/code\u003e: carrácter o cadena que representa un NULL en el fichero (por defecto \u0026quot;\u0026quot;)\u003c/li\u003e\n  \u003cli\u003e\u003ccode\u003ecompression\u003c/code\u003e: topo de compresión utilizada (por defecto \u0026ldquo;none\u0026rdquo;)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eLas opciones son similares para otros tipos de ficheros.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539075419857_847227899",
      "id": "20181009-085659_343569975",
      "dateCreated": "2018-10-09 08:56:59.000",
      "dateStarted": "2018-11-07 09:00:37.000",
      "dateFinished": "2018-11-07 09:00:37.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Vemos 5 filas\ndfSEInfered.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:12:52.548",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---+--------------------+---+--------------------+---+--------------------+----+--------------------+--------------------+----+----+----+----+\n|_c0|                 _c1|_c2|                 _c3|_c4|                 _c5| _c6|                 _c7|                 _c8| _c9|_c10|_c11|_c12|\n+---+--------------------+---+--------------------+---+--------------------+----+--------------------+--------------------+----+----+----+----+\n|  4|2013-11-11 18:21:...| 17|\u0026lt;p\u0026gt;The infi...| 23|2013-11-10 19:37:...|null|                null|                null|null|null|   2|1165|\n|  5|2013-11-10 20:31:...| 12|\u0026lt;p\u0026gt;Come cre...|  1|2013-11-10 19:44:...|  61|Cosa sapreste dir...| \u0026lt;word-choice\u0026gt;|   1|null|   1|1166|\n|  2|2013-11-10 20:31:...| 17|\u0026lt;p\u0026gt;Il verbo...|  5|2013-11-10 19:58:...|null|                null|                null|null|null|   2|1167|\n|  1|2014-07-25 13:15:...|154|\u0026lt;p\u0026gt;As part ...| 11|2013-11-10 22:03:...| 187|Ironic constructi...|\u0026lt;english-compa...|   4|1170|   1|1168|\n|  0|2013-11-10 22:15:...| 70|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|  3|2013-11-10 22:15:...|null|                null|                null|null|null|   2|1169|\n+---+--------------------+---+--------------------+---+--------------------+----+--------------------+--------------------+----+----+----+----+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539076386529_1216999450",
      "id": "20181009-091306_850254411",
      "dateCreated": "2018-10-09 09:13:06.000",
      "dateStarted": "2020-11-16 16:12:52.607",
      "dateFinished": "2020-11-16 16:12:52.813",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n// Vemos 5 filas\ndfSEInfered.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:35.672",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539077977916_1973359079",
      "id": "20181009-093937_1156559921",
      "dateCreated": "2018-10-09 09:39:37.000",
      "dateStarted": "2020-06-15 17:50:36.040",
      "dateFinished": "2020-06-15 17:50:36.753",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Vemos como se ha inferido el esquema\ndfSEInfered.schema",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:14:05.586",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "StructType(List(StructField(_c0,IntegerType,true),StructField(_c1,TimestampType,true),StructField(_c2,IntegerType,true),StructField(_c3,StringType,true),StructField(_c4,IntegerType,true),StructField(_c5,TimestampType,true),StructField(_c6,IntegerType,true),StructField(_c7,StringType,true),StructField(_c8,StringType,true),StructField(_c9,IntegerType,true),StructField(_c10,IntegerType,true),StructField(_c11,IntegerType,true),StructField(_c12,IntegerType,true)))"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539018678321_2108228229",
      "id": "20181008-171118_837244833",
      "dateCreated": "2018-10-08 17:11:18.000",
      "dateStarted": "2020-11-16 16:14:05.644",
      "dateFinished": "2020-11-16 16:14:05.688",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Otra forma de verlo\ndfSEInfered.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:13:58.656",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- _c0: integer (nullable \u003d true)\n |-- _c1: timestamp (nullable \u003d true)\n |-- _c2: integer (nullable \u003d true)\n |-- _c3: string (nullable \u003d true)\n |-- _c4: integer (nullable \u003d true)\n |-- _c5: timestamp (nullable \u003d true)\n |-- _c6: integer (nullable \u003d true)\n |-- _c7: string (nullable \u003d true)\n |-- _c8: string (nullable \u003d true)\n |-- _c9: integer (nullable \u003d true)\n |-- _c10: integer (nullable \u003d true)\n |-- _c11: integer (nullable \u003d true)\n |-- _c12: integer (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539018727985_2057102852",
      "id": "20181008-171207_2102526266",
      "dateCreated": "2018-10-08 17:12:07.000",
      "dateStarted": "2020-11-16 16:13:58.718",
      "dateFinished": "2020-11-16 16:13:58.755",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n// Otra forma de verlo\ndfSEInfered.printSchema",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:38.043",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539078054705_-2004996273",
      "id": "20181009-094054_1163617284",
      "dateCreated": "2018-10-09 09:40:54.000",
      "dateStarted": "2020-06-15 17:50:38.450",
      "dateFinished": "2020-06-15 17:50:38.810",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Leemos especificando el esquema",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:38.827",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eLeemos especificando el esquema\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539076499094_1647949045",
      "id": "20181009-091459_405161352",
      "dateCreated": "2018-10-09 09:14:59.000",
      "dateStarted": "2018-10-11 12:38:25.000",
      "dateFinished": "2018-10-11 12:38:25.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.types import *\n# Creo una lista con las cabeceras de cada columna\n# Nota: evitar espacios y caracteres no ascii en nombres de columnas\ncabecera \u003d ([\"nComs\", \"ultimaActividad\", \"userId\", \n            \"cuerpo\", \"puntos\", \"fechaCreacion\", \"numVistas\", \"titulo\", \n            \"tags\", \"nRespuestas\", \"respAceptadaId\", \"tipoPost\", \"id\"])\n            \n# Defino el esquema para los elementos de la tabla\n# StructType -\u003e Permite definir un esquema para el DF a partir de una lista de StructFields\n# StructField -\u003e Definen el nombre y tipo de cada columna, así como si es nullable o no (campo True)\ndfSE_Schema \u003d StructType([\n  StructField(cabecera[0], IntegerType(), True),\n  StructField(cabecera[1], TimestampType(), True),\n  StructField(cabecera[2], LongType(), True),\n  StructField(cabecera[3], StringType(), True),\n  StructField(cabecera[4], IntegerType(), True),\n  StructField(cabecera[5], TimestampType(), True),\n  StructField(cabecera[6], IntegerType(), True),\n  StructField(cabecera[7], StringType(), True),\n  StructField(cabecera[8], StringType(), True),\n  StructField(cabecera[9], IntegerType(), True),\n  StructField(cabecera[10], LongType(), True),\n  StructField(cabecera[11], ByteType(), True),\n  StructField(cabecera[12], LongType(), True)\n  ])\n  \ndfSE \u003d spark.read.format(\"csv\")\\\n                    .option(\"mode\", \"FAILFAST\")\\\n                    .option(\"sep\", \"~\")\\\n                    .option(\"inferSchema\", \"false\")\\\n                    .option(\"header\", \"false\")\\\n                    .option(\"nullValue\", \"null\")\\\n                    .option(\"compression\", \"bzip2\")\\\n                    .schema(dfSE_Schema)\\\n                    .load(\"/datos/italianPosts.csv.bz2\")\ndfSE.cache()                    ",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:14:37.630",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "DataFrame[nComs: int, ultimaActividad: timestamp, userId: bigint, cuerpo: string, puntos: int, fechaCreacion: timestamp, numVistas: int, titulo: string, tags: string, nRespuestas: int, respAceptadaId: bigint, tipoPost: tinyint, id: bigint]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539018762147_422461790",
      "id": "20181008-171242_1657070683",
      "dateCreated": "2018-10-08 17:12:42.000",
      "dateStarted": "2020-11-18 15:14:37.763",
      "dateFinished": "2020-11-18 15:14:39.198",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\nimport org.apache.spark.sql.types.{StructField, StructType, IntegerType, TimestampType, LongType, ByteType, StringType}\n// Creo un array con las cabeceras de cada columna\n// Nota: evitar espacios y caracteres no ascii en nombres de columnas\nval cabecera \u003d Array(\"nComs\", \"ultimaActividad\", \"userId\", \n            \"cuerpo\", \"puntos\", \"fechaCreacion\", \"numVistas\", \"titulo\", \n            \"tags\", \"nRespuestas\", \"respAceptadaId\", \"tipoPost\", \"id\")\n\n// Defino el esquema para los elementos de la tabla\n// StructType -\u003e Permite definir un esquema para el DF a partir de una lista de StructFields\n// StructField -\u003e Definen el nombre y tipo de cada columna, así como si es nullable o no (campo True)\nval dfSE_Schema \u003d StructType(Array(\n  StructField(cabecera(0), IntegerType, true),\n  StructField(cabecera(1), TimestampType, true),\n  StructField(cabecera(2), LongType, true),\n  StructField(cabecera(3), StringType, true),\n  StructField(cabecera(4), IntegerType, true),\n  StructField(cabecera(5), TimestampType, true),\n  StructField(cabecera(6), IntegerType, true),\n  StructField(cabecera(7), StringType, true),\n  StructField(cabecera(8), StringType, true),\n  StructField(cabecera(9), IntegerType, true),\n  StructField(cabecera(10), LongType, true),\n  StructField(cabecera(11), ByteType, true),\n  StructField(cabecera(12), LongType, true)\n  ))\n  \nval dfSE \u003d spark.read.format(\"csv\").\n                    option(\"mode\", \"FAILFAST\").\n                    option(\"sep\", \"~\").\n                    option(\"inferSchema\", \"false\").\n                    option(\"header\", \"false\").\n                    option(\"nullValue\", \"null\").\n                    option(\"compression\", \"bzip2\").\n                    schema(dfSE_Schema).\n                    load(\"/datos/italianPosts.csv.bz2\")\ndfSE.cache()                    ",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:14:50.379",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.types.{StructField, StructType, IntegerType, TimestampType, LongType, ByteType, StringType}\ncabecera: Array[String] \u003d Array(nComs, ultimaActividad, userId, cuerpo, puntos, fechaCreacion, numVistas, titulo, tags, nRespuestas, respAceptadaId, tipoPost, id)\ndfSE_Schema: org.apache.spark.sql.types.StructType \u003d StructType(StructField(nComs,IntegerType,true), StructField(ultimaActividad,TimestampType,true), StructField(userId,LongType,true), StructField(cuerpo,StringType,true), StructField(puntos,IntegerType,true), StructField(fechaCreacion,TimestampType,true), StructField(numVistas,IntegerType,true), StructField(titulo,StringType,true), StructField(tags,StringType,true), StructField(nRespuestas,IntegerType,true), StructField(respAceptadaId,LongType,true), StructFi..."
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539078088171_-1115247147",
      "id": "20181009-094128_890612836",
      "dateCreated": "2018-10-09 09:41:28.000",
      "dateStarted": "2020-11-18 15:14:50.484",
      "dateFinished": "2020-11-18 15:14:51.461",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndfSE.sort(\"id\").show()",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:16:14.117",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+---+\n|nComs|     ultimaActividad|userId|              cuerpo|puntos|       fechaCreacion|numVistas|              titulo|                tags|nRespuestas|respAceptadaId|tipoPost| id|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+---+\n|    2|2013-11-09 09:20:...|     8|\u0026lt;p\u0026gt;What is ...|    20|2013-11-05 20:22:...|      204|What are the rule...|\u0026lt;word-choice\u0026g...|          4|             2|       1|  1|\n|    9|2013-11-05 20:44:...|    17|\u0026lt;p\u0026gt;Translat...|    18|2013-11-05 20:36:...|     null|                null|                null|       null|          null|       2|  2|\n|    0|2013-11-05 20:37:...|     6|\u0026lt;p\u0026gt;[don\u0027t k...|     6|2013-11-05 20:37:...|     null|                null|                null|       null|          null|       2|  3|\n|    6|2013-11-07 17:27:...|    18|\u0026lt;p\u0026gt;Si sotto...|     4|2013-11-05 20:38:...|     null|                null|                null|       null|          null|       2|  4|\n|    5|2013-11-06 01:00:...|    18|\u0026lt;p\u0026gt;I am int...|    13|2013-11-05 20:46:...|      130|Tanto va la gatta...|    \u0026lt;proverbs\u0026gt;|          1|          null|       1|  5|\n|    0|2013-11-06 14:56:...|    18|\u0026lt;p\u0026gt;When an ...|    10|2013-11-05 21:01:...|      165|How do English wo...|     \u0026lt;grammar\u0026gt;|          4|             8|       1|  6|\n|    6|2013-11-05 21:09:...|     6|\u0026lt;p\u0026gt;While th...|    24|2013-11-05 21:09:...|     null|                null|                null|       null|          null|       2|  8|\n|    0|2013-11-06 10:25:...|    22|\u0026lt;p\u0026gt;Personal...|     6|2013-11-05 21:15:...|     null|                null|                null|       null|          null|       2|  9|\n|    2|2014-02-02 13:21:...|    17|\u0026lt;p\u0026gt;I often ...|    10|2013-11-05 21:29:...|      134|Is it correct to ...|\u0026lt;foreign-words...|          3|            12|       1| 10|\n|    0|2014-07-26 19:17:...|    12|\u0026lt;p\u0026gt;What\u0027s t...|     6|2013-11-05 21:30:...|       92|\u0027aver sceso le sc...|\u0026lt;grammar\u0026gt;\u0026l...|          1|          null|       1| 11|\n|    4|2013-11-05 21:36:...|    22|\u0026lt;p\u0026gt;Grammati...|    19|2013-11-05 21:36:...|     null|                null|                null|       null|          null|       2| 12|\n|    2|2013-11-05 21:56:...|    15|\u0026lt;p\u0026gt;\u0027\u0027avere\u0027...|     7|2013-11-05 21:40:...|     null|                null|                null|       null|          null|       2| 13|\n|    0|2013-11-07 17:27:...|    10|\u0026lt;p\u0026gt;I wasn\u0027t...|     1|2013-11-05 21:52:...|     null|                null|                null|       null|          null|       2| 14|\n|    1|2014-03-07 12:47:...|    37|\u0026lt;p\u0026gt;Are ther...|    13|2013-11-05 21:57:...|      557|Are there rules f...|    \u0026lt;pronouns\u0026gt;|          1|            20|       1| 15|\n|    0|2014-02-02 13:21:...|     8|\u0026lt;p\u0026gt;It\u0027s not...|     6|2013-11-05 22:00:...|     null|                null|                null|       null|          null|       2| 16|\n|    1|2013-11-06 09:32:...|    12|\u0026lt;p\u0026gt;What is ...|     4|2013-11-05 22:17:...|       76|\u0027apparire\u0027 vs. \u0027s...| \u0026lt;word-choice\u0026gt;|          3|          null|       1| 17|\n|    0|2013-11-06 09:53:...|    12|\u0026lt;p\u0026gt;Which on...|     2|2013-11-05 22:34:...|       78|\u0026quot;l\u0027FBI\u0026quot;...|\u0026lt;articles\u0026gt;\u0026...|          2|          null|       1| 18|\n|    0|2013-11-06 09:33:...|    12|\u0026lt;p\u0026gt;How does...|     2|2013-11-05 22:38:...|       69|\u0026quot;con \u0027degli\u0027...| \u0026lt;word-choice\u0026gt;|          2|            25|       1| 19|\n|    0|2013-11-05 23:07:...|     8|\u0026lt;p\u0026gt;From the...|    12|2013-11-05 22:42:...|     null|                null|                null|       null|          null|       2| 20|\n|    2|2013-11-05 22:47:...|    41|\u0026lt;p\u0026gt;IMO ther...|     2|2013-11-05 22:47:...|     null|                null|                null|       null|          null|       2| 21|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+---+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539019982438_-1323575232",
      "id": "20181008-173302_1923324821",
      "dateCreated": "2018-10-08 17:33:02.000",
      "dateStarted": "2020-11-16 16:16:14.176",
      "dateFinished": "2020-11-16 16:16:14.822",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndfSE.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:16:28.731",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- nComs: integer (nullable \u003d true)\n |-- ultimaActividad: timestamp (nullable \u003d true)\n |-- userId: long (nullable \u003d true)\n |-- cuerpo: string (nullable \u003d true)\n |-- puntos: integer (nullable \u003d true)\n |-- fechaCreacion: timestamp (nullable \u003d true)\n |-- numVistas: integer (nullable \u003d true)\n |-- titulo: string (nullable \u003d true)\n |-- tags: string (nullable \u003d true)\n |-- nRespuestas: integer (nullable \u003d true)\n |-- respAceptadaId: long (nullable \u003d true)\n |-- tipoPost: byte (nullable \u003d true)\n |-- id: long (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539019994903_1720994412",
      "id": "20181008-173314_1166146545",
      "dateCreated": "2018-10-08 17:33:14.000",
      "dateStarted": "2020-11-16 16:16:28.791",
      "dateFinished": "2020-11-16 16:16:28.836",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Operaciones básicas con DataFrames\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:42.867",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eOperaciones básicas con DataFrames\u003c/h1\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539075204692_1977525912",
      "id": "20181009-085324_552322930",
      "dateCreated": "2018-10-09 08:53:24.000",
      "dateStarted": "2018-10-11 09:30:38.000",
      "dateFinished": "2018-10-11 09:30:38.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Mostrar filas",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:42.867",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eMostrar filas\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079155401_605481412",
      "id": "20181009-095915_1737120628",
      "dateCreated": "2018-10-09 09:59:15.000",
      "dateStarted": "2018-10-09 10:03:38.000",
      "dateFinished": "2018-10-09 10:03:38.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# show(n) permite mostrar las primeras n filas (por defecto, n\u003d20)\ndfSE.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:17:10.041",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\n|nComs|     ultimaActividad|userId|              cuerpo|puntos|       fechaCreacion|numVistas|              titulo|                tags|nRespuestas|respAceptadaId|tipoPost|  id|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\n|    4|2013-11-11 18:21:...|    17|\u0026lt;p\u0026gt;The infi...|    23|2013-11-10 19:37:...|     null|                null|                null|       null|          null|       2|1165|\n|    5|2013-11-10 20:31:...|    12|\u0026lt;p\u0026gt;Come cre...|     1|2013-11-10 19:44:...|       61|Cosa sapreste dir...| \u0026lt;word-choice\u0026gt;|          1|          null|       1|1166|\n|    2|2013-11-10 20:31:...|    17|\u0026lt;p\u0026gt;Il verbo...|     5|2013-11-10 19:58:...|     null|                null|                null|       null|          null|       2|1167|\n|    1|2014-07-25 13:15:...|   154|\u0026lt;p\u0026gt;As part ...|    11|2013-11-10 22:03:...|      187|Ironic constructi...|\u0026lt;english-compa...|          4|          1170|       1|1168|\n|    0|2013-11-10 22:15:...|    70|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|     3|2013-11-10 22:15:...|     null|                null|                null|       null|          null|       2|1169|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079220190_2055927304",
      "id": "20181009-100020_1265058787",
      "dateCreated": "2018-10-09 10:00:20.000",
      "dateStarted": "2020-11-16 16:17:10.104",
      "dateFinished": "2020-11-16 16:17:10.174",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Podemos indicar que no trunque los campos largos\ndfSE.show(5, truncate\u003dFalse)",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:17:05.991",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----------------------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------+-----------------------+---------+------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+-----------+--------------+--------+----+\n|nComs|ultimaActividad        |userId|cuerpo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |puntos|fechaCreacion          |numVistas|titulo                                                                                                |tags                                                               |nRespuestas|respAceptadaId|tipoPost|id  |\n+-----+-----------------------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------+-----------------------+---------+------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+-----------+--------------+--------+----+\n|4    |2013-11-11 18:21:10.903|17    |\u0026lt;p\u0026gt;The infinitive tense is commonly used for expressing rules especially in signs (of any kind, not just road signs).\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;For instance\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Non fumare\u0026lt;br\u0026gt;  Non calpestare il prato\u0026lt;br\u0026gt;  Tenere la destra\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;The language \u0026quot;trick\u0026quot; behind this use of the infinitive form is the omission of the clause \u0026lt;em\u0026gt;Si prega di\u0026lt;/em\u0026gt; or equivalent, so the above sentences are read as\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;\u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;Si prega di\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; non fumare\u0026lt;br\u0026gt;  \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Si prega di\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; non calpestare il prato\u0026lt;br\u0026gt;  \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Si prega di\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; tenere la destra\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;Such form is not used in everyday\u0027s spoken language, as it\u0027s a convention used for giving orders and stating rules in an impersonal and formal way.\u0026lt;/p\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;p\u0026gt;That being said, there\u0027s an official use of the infinitive tense as imperative, which is the negative imperative.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;In Italian the positive imperative form goes as follows\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Tieni la destra!\u0026lt;br\u0026gt;  Parla con lei!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;whereas the negative imperative is formed with \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;non + infinitive tense\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, as in \u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Non tenere la destra!\u0026lt;br\u0026gt;  Non parlare con lei!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;p\u0026gt;As discussed in the comments, it\u0027s also nice to notice the differences and the similarities with other Romance languages, such as Spanish and French.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Apparently French has the same identical construct as Italian for expressing formal impersonal orders, for instance\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Ne pas fumer\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Non fumare\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;which is again a shortening for\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Merci de ne pas fumer\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Grazie di non fumare\u0026lt;/em\u0026gt; or more idiomatically \u0026lt;em\u0026gt;Si prega di non fumare\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;On the other hand Spanish behaves differently and it doesn\u0027t have a special construct for impersonal orders, rather just using the formal imperative form, which is formed with the subjunctive\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;No fume\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Non fumare\u0026lt;/em\u0026gt;, but also \u0026lt;em\u0026gt;Non fumi\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;or\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Reduzca la velocidad\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Ridurre la velocità\u0026lt;/em\u0026gt;, but also \u0026lt;em\u0026gt;Riduca la velocità\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;|23    |2013-11-10 19:37:54.187|null     |null                                                                                                  |null                                                               |null       |null          |2       |1165|\n|5    |2013-11-10 20:31:00.177|12    |\u0026lt;p\u0026gt;Come credo sia conosciuto da tutti quelli che usano viaggiare con l\u0027automobile, molti italiani hanno uno strano rapporto con gli abbaglianti; alcuni li amano così tanto che preferiscono mantenerli sempre accesi, altri invece li usano per segnalare, se non addirittura per comunicare informazioni di vario genere, dalla presenza di autovelox alla protesta per presunte violazioni del codice della strada.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Al di lá delle considerazioni e dei commenti circa queste abitudini, mi piacerebbe sapere se il verbo \u0026quot;sfanagliare\u0026quot; è normalmente usato, e compreso, in tutte le regioni italiane o se, magari, ci sono altri verbi in uso, purchè simpatici come quello.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Laddove qualcuno non avesse compreso l\u0027uso del aforementioned verbo, ecco un esempio:\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;\u0026quot;Ehi!\u0026quot; - dice il marito a sua moglie - \u0026quot;Quello li mi sta sfanagliando, st***o!\u0026quot;\u0026lt;/p\u0026gt;    \u0026lt;p\u0026gt;E la moglie, \u0026quot;Caro, rallenta; magari più avanti c\u0027è un autovelox, cribbio!\u0026quot;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |1     |2013-11-10 19:44:53.797|61       |Cosa sapreste dirmi della diffusione del verbo \u0026quot;sfanagliare\u0026quot; nelle diverse regioni italiane?|\u0026lt;word-choice\u0026gt;                                                |1          |null          |1       |1166|\n|2    |2013-11-10 20:31:00.177|17    |\u0026lt;p\u0026gt;Il verbo \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;sfanagliare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; è un verbo inventato, non esistente nella lingua italiana, ma questo penso fosse chiaro dalla domanda.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Personalmente non l\u0027ho mai sentito usare nel nord Italia, quindi non credo abbia una diffusione regionale omogenea. Un\u0027alternativa che mi è capitato invece di sentire  è \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;sfanalare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, con significato identico.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Ad ogni modo, non sono sicuro dell\u0027interpretazione di \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;sfanalare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;/\u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;sfanagliare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; con il significato di \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;accecare con gli abbaglianti\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;. Probabilmente il significato che gli attribuirei è lo stesso di \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;fare i fari\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, ossia \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;segnalare qualcosa tramite i fari abbaglianti\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, solitamente accendendoli e spegnedoli ripetutamente. Per esempio\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Non mi ero accorto che il semaforo fosse diventato verde e il tizio dietro mi ha fatto i fari\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;(ok l\u0027esempio è un po\u0027 tirato, sappiamo benissimo che il tizio di turno normalmente suona il clacson e tira una bestemmia...)\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;oppure\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Una vecchia consuetudine italiana era quella di sfanalare per segnalare la presenza della polizia stradale\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;Nell\u0027esempio che hai menzionato userei invece qualcosa del tipo\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Quello lì mi sta abbagliando (con sti c***o di fari, \u0026lt;em\u0026gt;ndt\u0026lt;/em\u0026gt;), st***o!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;or\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Quello lì mi sta accecando (con sti c***o di fari, \u0026lt;em\u0026gt;ndt\u0026lt;/em\u0026gt;), st***o!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |5     |2013-11-10 19:58:02.1  |null     |null                                                                                                  |null                                                               |null       |null          |2       |1167|\n|1    |2014-07-25 13:15:02.27 |154   |\u0026lt;p\u0026gt;As part of my masters in linguistics, I am taking a course on the subject of irony. We were given examples of sentences that are most likely ironic, as the English sentence \u0026quot;he is not exceptionally smart\u0026quot; (which has the structure \u0026quot;he is not exceptionally X\u0026quot;). This does not mean literally that he is smart at an exceptional level, but rather, ironically, that he is very stupid.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Are there similar constructions in Italian, preferably ones that involve superlative and negation?\u0026lt;/p\u0026gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |11    |2013-11-10 22:03:41.027|187      |Ironic constructions in Italian                                                                       |\u0026lt;english-comparison\u0026gt;\u0026lt;translation\u0026gt;\u0026lt;phrase-request\u0026gt;|4          |1170          |1       |1168|\n|0    |2013-11-10 22:15:17.693|70    |\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Non è furbissimo\u0026lt;/em\u0026gt; can be used in the same sense as your example; or \u0026lt;em\u0026gt;non è velocissimo\u0026lt;/em\u0026gt; for someone who\u0027s rather slow. Maybe adding \u0026lt;em\u0026gt;proprio\u0026lt;/em\u0026gt;: \u0026lt;em\u0026gt;non è proprio furbissimo\u0026lt;/em\u0026gt;, which is more explicit in denying the smartness of the person.\u0026lt;/p\u0026gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |3     |2013-11-10 22:15:17.693|null     |null                                                                                                  |null                                                               |null       |null          |2       |1169|\n+-----+-----------------------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------+-----------------------+---------+------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------+-----------+--------------+--------+----+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079246700_2099168588",
      "id": "20181009-100046_1466120024",
      "dateCreated": "2018-10-09 10:00:46.000",
      "dateStarted": "2020-11-16 16:17:06.058",
      "dateFinished": "2020-11-16 16:17:06.198",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# take(n) devuelve las n primeras filas como una lista Python de objetos Row\nlista \u003d dfSE.take(5)\nprint(lista[1])\nprint(\"\\n\")\n# collect() devuelve todo el DataFrame como una lista Python de objetos Row\n# Si el DataFrame es muy grande podría colapsar al Driver\nlista2 \u003d dfSE.collect()\nprint(lista2[10])",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:17:49.698",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Row(nComs\u003d5, ultimaActividad\u003ddatetime.datetime(2013, 11, 10, 20, 31, 0, 177000), userId\u003d12, cuerpo\u003du\"\u0026lt;p\u0026gt;Come credo sia conosciuto da tutti quelli che usano viaggiare con l\u0027automobile, molti italiani hanno uno strano rapporto con gli abbaglianti; alcuni li amano cos\\xec tanto che preferiscono mantenerli sempre accesi, altri invece li usano per segnalare, se non addirittura per comunicare informazioni di vario genere, dalla presenza di autovelox alla protesta per presunte violazioni del codice della strada.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Al di l\\xe1 delle considerazioni e dei commenti circa queste abitudini, mi piacerebbe sapere se il verbo \u0026quot;sfanagliare\u0026quot; \\xe8 normalmente usato, e compreso, in tutte le regioni italiane o se, magari, ci sono altri verbi in uso, purch\\xe8 simpatici come quello.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Laddove qualcuno non avesse compreso l\u0027uso del aforementioned verbo, ecco un esempio:\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;\u0026quot;Ehi!\u0026quot; - dice il marito a sua moglie - \u0026quot;Quello li mi sta sfanagliando, st***o!\u0026quot;\u0026lt;/p\u0026gt;    \u0026lt;p\u0026gt;E la moglie, \u0026quot;Caro, rallenta; magari pi\\xf9 avanti c\u0027\\xe8 un autovelox, cribbio!\u0026quot;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\", puntos\u003d1, fechaCreacion\u003ddatetime.datetime(2013, 11, 10, 19, 44, 53, 797000), numVistas\u003d61, titulo\u003du\u0027Cosa sapreste dirmi della diffusione del verbo \u0026quot;sfanagliare\u0026quot; nelle diverse regioni italiane?\u0027, tags\u003du\u0027\u0026lt;word-choice\u0026gt;\u0027, nRespuestas\u003d1, respAceptadaId\u003dNone, tipoPost\u003d1, id\u003d1166)\n\n\nRow(nComs\u003d1, ultimaActividad\u003ddatetime.datetime(2014, 1, 16, 19, 56, 5, 933000), userId\u003d63, cuerpo\u003du\u0027\u0026lt;p\u0026gt;Suppose I want to translate an English sentence like \u0026quot;I have walked in the park for a year.\u0026quot; The first though I had was translating the sentence as follows.\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Ho camminato nel parco per un anno.\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;It seems correct, except for the fact that Present Perfect is used to talk about a past event that is still relevant for the present. That means the sentence I used as example would be understood as saying that I am still walking in the park. Similarly, \u0026quot;I have gone to that store since I was a teenager.\u0026quot; would mean I am still going to that store.\u0026lt;br\u0026gt;That is not the meaning of \u0026quot;ho camminato nel parco per un anno\u0026quot; which means I am not walking anymore in the park.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;I thought of using the Simple Past, but I am not sure how to use it with a time reference. Apart that, \u0026lt;em\u0026gt;camminavo nel parco\u0026lt;/em\u0026gt; still means I am not anymore walking.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;How should I translate the Present Perfect used in English?\u0026lt;/p\u0026gt;\u0027, puntos\u003d4, fechaCreacion\u003ddatetime.datetime(2013, 11, 11, 11, 31, 2, 343000), numVistas\u003d114, titulo\u003du\u0027How should I translate the Present Perfect used in English?\u0027, tags\u003du\u0027\u0026lt;usage\u0026gt;\u0026lt;tenses\u0026gt;\u0026lt;english-comparison\u0026gt;\u0027, nRespuestas\u003d2, respAceptadaId\u003d1177, tipoPost\u003d1, id\u003d1175)\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079266270_1550010162",
      "id": "20181009-100106_140923083",
      "dateCreated": "2018-10-09 10:01:06.000",
      "dateStarted": "2020-11-16 16:17:49.758",
      "dateFinished": "2020-11-16 16:17:49.990",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nimport os\n# sample(withReplacement, fraction, seed\u003dNone) devuelve un nuevo Dataframe con una fracción de las filas\ndfSESampled \u003d dfSE.sample(False, 0.1, seed\u003dNone)\nprint(\"N de filas original \u003d {0}; n de filas muestreadas \u003d {1}\".format(dfSE.count(), dfSESampled.count()))",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:19:58.681",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "N de filas original \u003d 1261; n de filas muestreadas \u003d 128\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079300382_-171416094",
      "id": "20181009-100140_1864850457",
      "dateCreated": "2018-10-09 10:01:40.000",
      "dateStarted": "2020-11-16 16:19:58.736",
      "dateFinished": "2020-11-16 16:19:58.892",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# limit(n) limita a n el número de filas obtenidas\ndfSE_10filas \u003d dfSE.sample(False, 0.1, seed\u003dNone).limit(10)\nprint(\"N de filas muestreadas \u003d {0}\".format(dfSE_10filas.count()))\ndfSE_10filas.show()",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:20:18.368",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "N de filas muestreadas \u003d 10\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\n|nComs|     ultimaActividad|userId|              cuerpo|puntos|       fechaCreacion|numVistas|              titulo|                tags|nRespuestas|respAceptadaId|tipoPost|  id|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\n|    5|2013-11-11 18:25:...|    17|\u0026lt;p\u0026gt;Una velo...|     9|2013-11-11 18:25:...|     null|                null|                null|       null|          null|       2|1185|\n|    0|2013-11-12 09:26:...|    63|\u0026lt;p\u0026gt;The ones...|     2|2013-11-12 09:26:...|     null|                null|                null|       null|          null|       2|1200|\n|    0|2013-11-12 12:36:...|    63|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|     4|2013-11-12 12:36:...|     null|                null|                null|       null|          null|       2|1215|\n|    1|2013-11-12 14:31:...|    82|\u0026lt;p\u0026gt;As far a...|     3|2013-11-12 14:31:...|     null|                null|                null|       null|          null|       2|1227|\n|    2|2013-11-12 17:42:...|    19|\u0026lt;p\u0026gt;In your ...|     2|2013-11-12 15:54:...|     null|                null|                null|       null|          null|       2|1232|\n|    0|2013-11-13 00:32:...|    19|\u0026lt;p\u0026gt;Il sito ...|     8|2013-11-13 00:04:...|     null|                null|                null|       null|          null|       2|1247|\n|    2|2013-11-14 10:06:...|    68|\u0026lt;p\u0026gt;Some adj...|    13|2013-11-13 12:19:...|      221|What is the rule ...|\u0026lt;grammar\u0026gt;\u0026l...|          2|          1256|       1|1248|\n|    2|2013-11-13 18:45:...|    19|\u0026lt;p\u0026gt;Secondo ...|     5|2013-11-13 18:45:...|     null|                null|                null|       null|          null|       2|1251|\n|    1|2013-11-13 23:01:...|    63|\u0026lt;p\u0026gt;L\u0027espres...|     8|2013-11-13 19:35:...|     null|                null|                null|       null|          null|       2|1257|\n|    0|2013-11-14 00:54:...|   159|\u0026lt;p\u0026gt;Mi è cap...|     7|2013-11-14 00:19:...|       70|\u0026quot;Diménticate...|       \u0026lt;verbs\u0026gt;|          1|          null|       1|1258|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539165000368_202928434",
      "id": "20181010-095000_1586478831",
      "dateCreated": "2018-10-10 09:50:00.000",
      "dateStarted": "2020-11-16 16:20:18.427",
      "dateFinished": "2020-11-16 16:20:18.663",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Ejecutar una operación sobre cada una de las filas\nEl método `foreach` aplica una función a cada una de las filas\n\n- El DataFrame no se modifica y no se crea ningún otro DataFrame\n- El `foreach`se ejecuta en los workers",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:47.192",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eEjecutar una operación sobre cada una de las filas\u003c/h3\u003e\n\u003cp\u003eEl método \u003ccode\u003eforeach\u003c/code\u003e aplica una función a cada una de las filas\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eEl DataFrame no se modifica y no se crea ningún otro DataFrame\u003c/li\u003e\n  \u003cli\u003eEl \u003ccode\u003eforeach\u003c/code\u003ese ejecuta en los workers\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541532047085_1668409566",
      "id": "20181106-192047_647308949",
      "dateCreated": "2018-11-06 19:20:47.000",
      "dateStarted": "2018-11-06 19:53:21.000",
      "dateFinished": "2018-11-06 19:53:21.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndef printid(f):\n    print(f[\"id\"])\n    \n# En teoría, deberían de imprimirse todos los valores de la columna id\n# Debido a la forma de gestionar las tareas del Zeppelin, no se ve\n# En un pyspark-shell si funciona\ndfSE_10filas.foreach(printid)\n",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:21:19.670",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1541531516473_-579468068",
      "id": "20181106-191156_1348844601",
      "dateCreated": "2018-11-06 19:11:56.000",
      "dateStarted": "2020-11-16 16:21:19.731",
      "dateFinished": "2020-11-16 16:21:19.836",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Seleccionar columnas",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:47.583",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eSeleccionar columnas\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079348816_1516231638",
      "id": "20181009-100228_1421918198",
      "dateCreated": "2018-10-09 10:02:28.000",
      "dateStarted": "2018-10-31 10:06:54.000",
      "dateFinished": "2018-10-31 10:06:54.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\n# Crea un nuevo DataFrame seleccionando columnas por nombre\ndfIdCuerpo \u003d dfSE.select(\"id\", \"cuerpo\")\ndfIdCuerpo.show(5)\n\nprint(\"El objeto dfIdCuerpo es de tipo {0}\".format(type(dfIdCuerpo)))",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:23:55.752",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+--------------------+\n|  id|              cuerpo|\n+----+--------------------+\n|1165|\u0026lt;p\u0026gt;The infi...|\n|1166|\u0026lt;p\u0026gt;Come cre...|\n|1167|\u0026lt;p\u0026gt;Il verbo...|\n|1168|\u0026lt;p\u0026gt;As part ...|\n|1169|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|\n+----+--------------------+\nonly showing top 5 rows\n\nEl objeto dfIdCuerpo es de tipo \u003cclass \u0027pyspark.sql.dataframe.DataFrame\u0027\u003e\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079428650_-938983439",
      "id": "20181009-100348_1116649440",
      "dateCreated": "2018-10-09 10:03:48.000",
      "dateStarted": "2020-11-16 16:23:55.802",
      "dateFinished": "2020-11-16 16:23:55.874",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Otra forma de indicar a las columnas\ndfIdCuerpo2 \u003d dfSE.select(dfSE.id, dfSE.cuerpo)\ndfIdCuerpo2.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:48.025",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1540981701567_-1868890780",
      "id": "20181031-102821_137098931",
      "dateCreated": "2018-10-31 10:28:21.000",
      "dateStarted": "2020-06-15 17:50:48.176",
      "dateFinished": "2020-06-15 17:50:48.301",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# También es posible indicar objetos de tipo Column\nfrom pyspark.sql.functions import col\n\ncolId \u003d col(\"id\")\ncolCreaDate \u003d col(\"fechaCreacion\")\nprint(\"El objeto colId es de tipo {0}\".format(type(colId)))\nprint(\"El objeto colCreaDate es de tipo {0}\".format(type(colCreaDate)))",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:15:16.848",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "El objeto colId es de tipo \u003cclass \u0027pyspark.sql.column.Column\u0027\u003e\nEl objeto colCreaDate es de tipo \u003cclass \u0027pyspark.sql.column.Column\u0027\u003e\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079483077_448412398",
      "id": "20181009-100443_752473638",
      "dateCreated": "2018-10-09 10:04:43.000",
      "dateStarted": "2020-11-18 15:15:16.963",
      "dateFinished": "2020-11-18 15:15:17.052",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Y crear un DataFrame a partir de objetos Column, renombrando columnas\ndfIdFechaCuerpo \u003d dfSE.select(colId, \n                              colCreaDate.alias(\"Fecha_Creacion\"), \n                              dfSE.cuerpo.alias(\"Cuerpo\"))\ndfIdFechaCuerpo.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:27:11.968",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+--------------------+--------------------+\n|  id|      Fecha_Creacion|              Cuerpo|\n+----+--------------------+--------------------+\n|1165|2013-11-10 19:37:...|\u0026lt;p\u0026gt;The infi...|\n|1166|2013-11-10 19:44:...|\u0026lt;p\u0026gt;Come cre...|\n|1167|2013-11-10 19:58:...|\u0026lt;p\u0026gt;Il verbo...|\n|1168|2013-11-10 22:03:...|\u0026lt;p\u0026gt;As part ...|\n|1169|2013-11-10 22:15:...|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|\n+----+--------------------+--------------------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539079549543_-1945142550",
      "id": "20181009-100549_770105509",
      "dateCreated": "2018-10-09 10:05:49.000",
      "dateStarted": "2020-11-16 16:27:12.018",
      "dateFinished": "2020-11-16 16:27:12.092",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.functions import expr\n# El DataFrame anterior usando expresiones\ndfIdFechaCuerpoExpr \u003d dfSE.select(\n                           expr(\"id AS ID\"), \n                           expr(\u0027fechaCreacion AS Fecha_Creacion\u0027), \n                           expr(\"cuerpo AS Cuerpo\"))\ndfIdFechaCuerpoExpr.show(5)\n",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:27:37.435",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+--------------------+--------------------+\n|  ID|      Fecha_Creacion|              Cuerpo|\n+----+--------------------+--------------------+\n|1165|2013-11-10 19:37:...|\u0026lt;p\u0026gt;The infi...|\n|1166|2013-11-10 19:44:...|\u0026lt;p\u0026gt;Come cre...|\n|1167|2013-11-10 19:58:...|\u0026lt;p\u0026gt;Il verbo...|\n|1168|2013-11-10 22:03:...|\u0026lt;p\u0026gt;As part ...|\n|1169|2013-11-10 22:15:...|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|\n+----+--------------------+--------------------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1540978924240_-614626556",
      "id": "20181031-094204_1706758211",
      "dateCreated": "2018-10-31 09:42:04.000",
      "dateStarted": "2020-11-16 16:27:37.488",
      "dateFinished": "2020-11-16 16:27:37.598",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Se pueden usar expresiones más complejas\ndfSE.selectExpr(\"*\", # Selecciona todas las columnas\n                \"(nRespuestas IS NOT NULL) as respuestaValida\").show()",
      "user": "anonymous",
      "dateUpdated": "2020-11-16 16:27:56.957",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+---------------+\n|nComs|     ultimaActividad|userId|              cuerpo|puntos|       fechaCreacion|numVistas|              titulo|                tags|nRespuestas|respAceptadaId|tipoPost|  id|respuestaValida|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+---------------+\n|    4|2013-11-11 18:21:...|    17|\u0026lt;p\u0026gt;The infi...|    23|2013-11-10 19:37:...|     null|                null|                null|       null|          null|       2|1165|          false|\n|    5|2013-11-10 20:31:...|    12|\u0026lt;p\u0026gt;Come cre...|     1|2013-11-10 19:44:...|       61|Cosa sapreste dir...| \u0026lt;word-choice\u0026gt;|          1|          null|       1|1166|           true|\n|    2|2013-11-10 20:31:...|    17|\u0026lt;p\u0026gt;Il verbo...|     5|2013-11-10 19:58:...|     null|                null|                null|       null|          null|       2|1167|          false|\n|    1|2014-07-25 13:15:...|   154|\u0026lt;p\u0026gt;As part ...|    11|2013-11-10 22:03:...|      187|Ironic constructi...|\u0026lt;english-compa...|          4|          1170|       1|1168|           true|\n|    0|2013-11-10 22:15:...|    70|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|     3|2013-11-10 22:15:...|     null|                null|                null|       null|          null|       2|1169|          false|\n|    2|2013-11-10 22:17:...|    17|\u0026lt;p\u0026gt;There\u0027s ...|     8|2013-11-10 22:17:...|     null|                null|                null|       null|          null|       2|1170|          false|\n|    1|2013-11-11 09:51:...|    63|\u0026lt;p\u0026gt;As other...|     3|2013-11-11 09:51:...|     null|                null|                null|       null|          null|       2|1171|          false|\n|    1|2013-11-12 23:57:...|    63|\u0026lt;p\u0026gt;The expr...|     1|2013-11-11 10:09:...|     null|                null|                null|       null|          null|       2|1172|          false|\n|    9|2014-01-05 11:13:...|    63|\u0026lt;p\u0026gt;When I w...|     5|2013-11-11 10:28:...|      122|Is \u0026quot;scancell...|\u0026lt;usage\u0026gt;\u0026lt;...|          3|          1181|       1|1173|           true|\n|    0|2013-11-11 10:58:...|    18|\u0026lt;p\u0026gt;Wow, wha...|     5|2013-11-11 10:58:...|     null|                null|                null|       null|          null|       2|1174|          false|\n|    1|2014-01-16 19:56:...|    63|\u0026lt;p\u0026gt;Suppose ...|     4|2013-11-11 11:31:...|      114|How should I tran...|\u0026lt;usage\u0026gt;\u0026lt;...|          2|          1177|       1|1175|           true|\n|    0|2013-11-11 14:36:...|    63|\u0026lt;p\u0026gt;Except w...|     3|2013-11-11 11:39:...|       58|Using a comma bet...|\u0026lt;usage\u0026gt;\u0026lt;...|          2|          1182|       1|1176|           true|\n|    3|2014-01-16 19:56:...|    71|\u0026lt;p\u0026gt;Both you...|     6|2013-11-11 11:57:...|     null|                null|                null|       null|          null|       2|1177|          false|\n|    0|2013-11-11 12:00:...|    12|\u0026lt;blockquote\u0026gt...|     1|2013-11-11 12:00:...|     null|                null|                null|       null|          null|       2|1178|          false|\n|    0|2013-11-12 11:24:...|    63|\u0026lt;p\u0026gt;Comparin...|     3|2013-11-11 12:58:...|       60|Using the conditi...|\u0026lt;usage\u0026gt;\u0026lt;...|          2|          1180|       1|1179|           true|\n|    4|2013-11-11 19:54:...|    18|\u0026lt;p\u0026gt;Using th...|     5|2013-11-11 13:48:...|     null|                null|                null|       null|          null|       2|1180|          false|\n|    0|2013-11-11 18:20:...|   132|\u0026lt;p\u0026gt;I would ...|     8|2013-11-11 14:04:...|     null|                null|                null|       null|          null|       2|1181|          false|\n|    1|2013-11-11 14:36:...|   132|\u0026lt;p\u0026gt;Putting ...|    11|2013-11-11 14:17:...|     null|                null|                null|       null|          null|       2|1182|          false|\n|    2|2013-11-14 09:56:...|    22|\u0026lt;p\u0026gt;Many peo...|     6|2013-11-11 14:43:...|      321|Can Dante Alighie...|\u0026lt;history\u0026gt;\u0026l...|          1|          1263|       1|1183|           true|\n|    2|2013-11-11 23:23:...|   159|\u0026lt;p\u0026gt;Sono un\u0027...|     7|2013-11-11 18:19:...|      138|origine dell\u0027espr...|\u0026lt;idioms\u0026gt;\u0026lt...|          2|          1185|       1|1184|           true|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+---------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1540980795557_1419310654",
      "id": "20181031-101315_1691464862",
      "dateCreated": "2018-10-31 10:13:15.000",
      "dateStarted": "2020-11-16 16:27:57.019",
      "dateFinished": "2020-11-16 16:27:57.240",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Renombrar, añadir y eliminar columnas\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:50.367",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eRenombrar, añadir y eliminar columnas\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539081940016_-2079597242",
      "id": "20181009-104540_740846072",
      "dateCreated": "2018-10-09 10:45:40.000",
      "dateStarted": "2020-06-15 17:50:50.471",
      "dateFinished": "2020-06-15 17:50:50.481",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Renombramos la columna creationDate\ndfSE \u003d dfSE.withColumnRenamed(\"fechaCreacion\", \"Fecha_de_creacion\")\ndfSE.cache()\ndfSE.select(\"Fecha_de_creacion\", \n            dfSE.numVistas.alias(\"Numero_de_vistas\"), \n            \"puntos\", \n            \"tipoPost\")\\\n            .show(truncate\u003dFalse)",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:17:22.343",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------------+----------------+------+--------+\n|Fecha_de_creacion      |Numero_de_vistas|puntos|tipoPost|\n+-----------------------+----------------+------+--------+\n|2013-11-10 19:37:54.187|null            |23    |2       |\n|2013-11-10 19:44:53.797|61              |1     |1       |\n|2013-11-10 19:58:02.1  |null            |5     |2       |\n|2013-11-10 22:03:41.027|187             |11    |1       |\n|2013-11-10 22:15:17.693|null            |3     |2       |\n|2013-11-10 22:17:22.38 |null            |8     |2       |\n|2013-11-11 09:51:11.22 |null            |3     |2       |\n|2013-11-11 10:09:05.117|null            |1     |2       |\n|2013-11-11 10:28:12.613|122             |5     |1       |\n|2013-11-11 10:58:02.62 |null            |5     |2       |\n|2013-11-11 11:31:02.343|114             |4     |1       |\n|2013-11-11 11:39:12.703|58              |3     |1       |\n|2013-11-11 11:57:03.723|null            |6     |2       |\n|2013-11-11 12:00:25.583|null            |1     |2       |\n|2013-11-11 12:58:38.137|60              |3     |1       |\n|2013-11-11 13:48:24.287|null            |5     |2       |\n|2013-11-11 14:04:00.753|null            |8     |2       |\n|2013-11-11 14:17:44.79 |null            |11    |2       |\n|2013-11-11 14:43:47.487|321             |6     |1       |\n|2013-11-11 18:19:12.253|138             |7     |1       |\n+-----------------------+----------------+------+--------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539081714750_-869798548",
      "id": "20181009-104154_1045834804",
      "dateCreated": "2018-10-09 10:41:54.000",
      "dateStarted": "2020-11-18 15:17:22.418",
      "dateFinished": "2020-11-18 15:17:22.791",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Añadimos una nueva columna con todos sus valores iguales a 1\nfrom pyspark.sql.functions import lit\n# lit convierte un literal en Python al formato interno de Spark \n# (en este ejemplo IntegerType)\ndfSE \u003d dfSE.withColumn(\"unos\", lit(1))\ndfSE.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:17:25.358",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+----+\n|nComs|     ultimaActividad|userId|              cuerpo|puntos|   Fecha_de_creacion|numVistas|              titulo|                tags|nRespuestas|respAceptadaId|tipoPost|  id|unos|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+----+\n|    4|2013-11-11 18:21:...|    17|\u0026lt;p\u0026gt;The infi...|    23|2013-11-10 19:37:...|     null|                null|                null|       null|          null|       2|1165|   1|\n|    5|2013-11-10 20:31:...|    12|\u0026lt;p\u0026gt;Come cre...|     1|2013-11-10 19:44:...|       61|Cosa sapreste dir...| \u0026lt;word-choice\u0026gt;|          1|          null|       1|1166|   1|\n|    2|2013-11-10 20:31:...|    17|\u0026lt;p\u0026gt;Il verbo...|     5|2013-11-10 19:58:...|     null|                null|                null|       null|          null|       2|1167|   1|\n|    1|2014-07-25 13:15:...|   154|\u0026lt;p\u0026gt;As part ...|    11|2013-11-10 22:03:...|      187|Ironic constructi...|\u0026lt;english-compa...|          4|          1170|       1|1168|   1|\n|    0|2013-11-10 22:15:...|    70|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|     3|2013-11-10 22:15:...|     null|                null|                null|       null|          null|       2|1169|   1|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+----+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539192234906_-636546615",
      "id": "20181010-172354_802797726",
      "dateCreated": "2018-10-10 17:23:54.000",
      "dateStarted": "2020-11-18 15:17:25.419",
      "dateFinished": "2020-11-18 15:17:25.887",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Elimina una columna con drop\ndfSE \u003d dfSE.drop(col(\"unos\"))\ndfSE.columns",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:17:28.327",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[\u0027nComs\u0027,\n \u0027ultimaActividad\u0027,\n \u0027userId\u0027,\n \u0027cuerpo\u0027,\n \u0027puntos\u0027,\n \u0027Fecha_de_creacion\u0027,\n \u0027numVistas\u0027,\n \u0027titulo\u0027,\n \u0027tags\u0027,\n \u0027nRespuestas\u0027,\n \u0027respAceptadaId\u0027,\n \u0027tipoPost\u0027,\n \u0027id\u0027]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539192826824_2083497767",
      "id": "20181010-173346_1928715468",
      "dateCreated": "2018-10-10 17:33:46.000",
      "dateStarted": "2020-11-18 15:17:28.393",
      "dateFinished": "2020-11-18 15:17:28.459",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Eliminar valores nulos y duplicados",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:51.850",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eEliminar valores nulos y duplicados\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539082044628_-333852683",
      "id": "20181009-104724_91257918",
      "dateCreated": "2018-10-09 10:47:24.000",
      "dateStarted": "2018-11-04 12:40:37.000",
      "dateFinished": "2018-11-04 12:40:37.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Eliminamos todas las filas que tengan null en alguna de sus columnas\ndfNoNulls \u003d dfSE.dropna(\"any\")\nprint(\"Numero de filas inicial: {0}; número de filas sin null: {1}\"\n       .format(dfSE.count(), dfNoNulls.count()))\n",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:18:04.070",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Numero de filas inicial: 1261; número de filas sin null: 222\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539082205030_-693698461",
      "id": "20181009-105005_1682310281",
      "dateCreated": "2018-10-09 10:50:05.000",
      "dateStarted": "2020-11-18 15:18:04.146",
      "dateFinished": "2020-11-18 15:18:04.815",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Elimina las filas que tengan null en todas sus columnas\ndfNingunNull \u003d dfSE.dropna(\"all\")\nprint(\"Número de filas con todo a null: {0}\"\n       .format(dfSE.count() - dfNingunNull.count()))",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:18:27.549",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Número de filas con todo a null: 0\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539082268072_-1927534176",
      "id": "20181009-105108_1122563974",
      "dateCreated": "2018-10-09 10:51:08.000",
      "dateStarted": "2020-11-18 15:18:27.642",
      "dateFinished": "2020-11-18 15:18:27.971",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Elimina las filas duplicadas\ndfSinDuplicadas \u003d dfSE.dropDuplicates()\nprint(\"Número de filas duplicadas: {0}\"\n       .format(dfSE.count() - dfSinDuplicadas.count()))",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:18:47.981",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Número de filas duplicadas: 0\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541335257130_-429503921",
      "id": "20181104-124057_1822784091",
      "dateCreated": "2018-11-04 12:40:57.000",
      "dateStarted": "2020-11-18 15:18:48.050",
      "dateFinished": "2020-11-18 15:18:49.273",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Elimina las filas duplicadas en alguna columna\ndfSinUserDuplicado \u003d dfSE.dropDuplicates([\"userId\"])\nprint(\"Número de usuarios únicos: {0}\"\n       .format(dfSinUserDuplicado.count()))",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:19:12.349",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Número de usuarios únicos: 218\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541335419259_624051154",
      "id": "20181104-124339_732103284",
      "dateCreated": "2018-11-04 12:43:39.000",
      "dateStarted": "2020-11-18 15:19:12.412",
      "dateFinished": "2020-11-18 15:19:13.264",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Otros ejemplos\ndfNoNullnumVistasrespAceptadaId \u003d dfSE\\\n        .dropna(\"any\", subset\u003d[\"numVistas\", \"respAceptadaId\"])\nprint(\"Número de filas con numVistas y respAceptadaId no nulo: {0}\"\n       .format(dfNoNullnumVistasrespAceptadaId.count()))\ndfNoNullnumVistasrespAceptadaId \u003d dfSE\\\n        .dropna(\"all\", subset\u003d[\"numVistas\", \"respAceptadaId\"])\nprint(\"Número de filas con numVistas o respAceptadaId no nulo: {0}\"\n       .format(dfNoNullnumVistasrespAceptadaId.count()))",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:19:32.587",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Número de filas con numVistas y respAceptadaId no nulo: 222\nNúmero de filas con numVistas o respAceptadaId no nulo: 374\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539082302776_508598179",
      "id": "20181009-105142_883546663",
      "dateCreated": "2018-10-09 10:51:42.000",
      "dateStarted": "2020-11-18 15:19:32.659",
      "dateFinished": "2020-11-18 15:19:32.967",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Reemplazar valores",
      "user": "anonymous",
      "dateUpdated": "2020-06-15 17:50:58.874",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eReemplazar valores\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539082515836_-951549609",
      "id": "20181009-105515_178661916",
      "dateCreated": "2018-10-09 10:55:15.000",
      "dateStarted": "2018-10-31 10:15:40.000",
      "dateFinished": "2018-10-31 10:15:40.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Reemplazamos los null en los campos numVistas y nRespuestas\ndfSE \u003d dfSE.fillna(0, subset\u003d[\"numVistas\", \"nRespuestas\"])\ndfSE.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:21:06.582",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\n|nComs|     ultimaActividad|userId|              cuerpo|puntos|   Fecha_de_creacion|numVistas|              titulo|                tags|nRespuestas|respAceptadaId|tipoPost|  id|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\n|    4|2013-11-11 18:21:...|    17|\u0026lt;p\u0026gt;The infi...|    23|2013-11-10 19:37:...|        0|                null|                null|          0|          null|       2|1165|\n|    5|2013-11-10 20:31:...|    12|\u0026lt;p\u0026gt;Come cre...|     1|2013-11-10 19:44:...|       61|Cosa sapreste dir...| \u0026lt;word-choice\u0026gt;|          1|          null|       1|1166|\n|    2|2013-11-10 20:31:...|    17|\u0026lt;p\u0026gt;Il verbo...|     5|2013-11-10 19:58:...|        0|                null|                null|          0|          null|       2|1167|\n|    1|2014-07-25 13:15:...|   154|\u0026lt;p\u0026gt;As part ...|    11|2013-11-10 22:03:...|      187|Ironic constructi...|\u0026lt;english-compa...|          4|          1170|       1|1168|\n|    0|2013-11-10 22:15:...|    70|\u0026lt;p\u0026gt;\u0026lt;em\u0026g...|     3|2013-11-10 22:15:...|        0|                null|                null|          0|          null|       2|1169|\n+-----+--------------------+------+--------------------+------+--------------------+---------+--------------------+--------------------+-----------+--------------+--------+----+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539100456659_1537410684",
      "id": "20181009-155416_378463946",
      "dateCreated": "2018-10-09 15:54:16.000",
      "dateStarted": "2020-11-18 15:21:06.646",
      "dateFinished": "2020-11-18 15:21:06.796",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Reemplaza el valor 1170 por 3000 en las columnas \"id\" y \"acceptedAnswerId\"\ndfSE.select(\"id\", \"respAceptadaId\").show(10)\ndfSE.replace(1170, 3000, subset\u003d[\"id\", \"respAceptadaId\"])\\\n    .select(\"id\", \"respAceptadaId\")\\\n    .show(10)",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:21:54.103",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+--------------+\n|  id|respAceptadaId|\n+----+--------------+\n|1165|          null|\n|1166|          null|\n|1167|          null|\n|1168|          1170|\n|1169|          null|\n|1170|          null|\n|1171|          null|\n|1172|          null|\n|1173|          1181|\n|1174|          null|\n+----+--------------+\nonly showing top 10 rows\n\n+----+--------------+\n|  id|respAceptadaId|\n+----+--------------+\n|1165|          null|\n|1166|          null|\n|1167|          null|\n|1168|          3000|\n|1169|          null|\n|3000|          null|\n|1171|          null|\n|1172|          null|\n|1173|          1181|\n|1174|          null|\n+----+--------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541499064175_56321064",
      "id": "20181106-101104_1626454871",
      "dateCreated": "2018-11-06 10:11:04.000",
      "dateStarted": "2020-11-18 15:21:54.165",
      "dateFinished": "2020-11-18 15:21:54.463",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Guardando DataFrames\n\nAl igual que con la lectura, Spark puede guardar los DataFrames en múltiples formatos\n\n- CSV, JSON, Parquet, Hadoop...\n\nTambién puede escribir en bases de datos",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:23:22.427",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eGuardando DataFrames\u003c/h1\u003e\n\u003cp\u003eAl igual que con la lectura, Spark puede guardar los DataFrames en múltiples formatos\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eCSV, JSON, Parquet, Hadoop\u0026hellip;\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTambién puede escribir en bases de datos\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539100772490_-440069142",
      "id": "20181009-155932_1816250660",
      "dateCreated": "2018-10-09 15:59:32.000",
      "dateStarted": "2020-11-18 15:23:22.427",
      "dateFinished": "2020-11-18 15:23:24.879",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Guardo el DataFrame dfSE en formato JSON\ndfSE.write.format(\"json\")\\\n    .mode(\"overwrite\")\\\n    .save(\"/datos/dfSE.json\")",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:25:14.510",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1539193143585_1460095200",
      "id": "20181010-173903_1191418314",
      "dateCreated": "2018-10-10 17:39:03.000",
      "dateStarted": "2020-11-18 15:25:14.574",
      "dateFinished": "2020-11-18 15:25:14.937",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\nls -lh /datos\nls -lh /datos/dfSE.json\nhead /datos/dfSE.json/part-00000-7aa919b6-ba9a-42f9-9d9d-8330db9bb3c0-c000.json",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:26:18.320",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total 2.5M\n-rw------- 1 1000 1000 7.0K Sep 26 17:10 2015-summary.csv\ndrwx------ 2 1000 1000  12K Sep 26 17:10 by-day\ndrwxr-xr-x 2 root root 4.0K Nov 18 15:25 dfSE.json\n-rw------- 1 1000 1000 290K Sep 26 17:10 italianPosts.csv.bz2\n-rw------- 1 1000 1000 2.1M Sep 26 17:10 quijote.txt\ntotal 1.4M\n-rw-r--r-- 1 root root 1.4M Nov 18 15:25 part-00000-7aa919b6-ba9a-42f9-9d9d-8330db9bb3c0-c000.json\n-rw-r--r-- 1 root root    0 Nov 18 15:25 _SUCCESS\n{\"nComs\":4,\"ultimaActividad\":\"2013-11-11T18:21:10.903Z\",\"userId\":17,\"cuerpo\":\"\u0026lt;p\u0026gt;The infinitive tense is commonly used for expressing rules especially in signs (of any kind, not just road signs).\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;For instance\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Non fumare\u0026lt;br\u0026gt;  Non calpestare il prato\u0026lt;br\u0026gt;  Tenere la destra\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;The language \u0026quot;trick\u0026quot; behind this use of the infinitive form is the omission of the clause \u0026lt;em\u0026gt;Si prega di\u0026lt;/em\u0026gt; or equivalent, so the above sentences are read as\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;\u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;Si prega di\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; non fumare\u0026lt;br\u0026gt;  \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Si prega di\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; non calpestare il prato\u0026lt;br\u0026gt;  \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Si prega di\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; tenere la destra\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;Such form is not used in everyday\u0027s spoken language, as it\u0027s a convention used for giving orders and stating rules in an impersonal and formal way.\u0026lt;/p\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;p\u0026gt;That being said, there\u0027s an official use of the infinitive tense as imperative, which is the negative imperative.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;In Italian the positive imperative form goes as follows\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Tieni la destra!\u0026lt;br\u0026gt;  Parla con lei!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;whereas the negative imperative is formed with \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;non + infinitive tense\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, as in \u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Non tenere la destra!\u0026lt;br\u0026gt;  Non parlare con lei!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;p\u0026gt;As discussed in the comments, it\u0027s also nice to notice the differences and the similarities with other Romance languages, such as Spanish and French.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Apparently French has the same identical construct as Italian for expressing formal impersonal orders, for instance\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Ne pas fumer\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Non fumare\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;which is again a shortening for\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Merci de ne pas fumer\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Grazie di non fumare\u0026lt;/em\u0026gt; or more idiomatically \u0026lt;em\u0026gt;Si prega di non fumare\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;On the other hand Spanish behaves differently and it doesn\u0027t have a special construct for impersonal orders, rather just using the formal imperative form, which is formed with the subjunctive\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;No fume\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Non fumare\u0026lt;/em\u0026gt;, but also \u0026lt;em\u0026gt;Non fumi\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;or\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Reduzca la velocidad\u0026lt;br\u0026gt;  \u0026lt;em\u0026gt;Ridurre la velocità\u0026lt;/em\u0026gt;, but also \u0026lt;em\u0026gt;Riduca la velocità\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\",\"puntos\":23,\"Fecha_de_creacion\":\"2013-11-10T19:37:54.187Z\",\"numVistas\":0,\"nRespuestas\":0,\"tipoPost\":2,\"id\":1165}\n{\"nComs\":5,\"ultimaActividad\":\"2013-11-10T20:31:00.177Z\",\"userId\":12,\"cuerpo\":\"\u0026lt;p\u0026gt;Come credo sia conosciuto da tutti quelli che usano viaggiare con l\u0027automobile, molti italiani hanno uno strano rapporto con gli abbaglianti; alcuni li amano così tanto che preferiscono mantenerli sempre accesi, altri invece li usano per segnalare, se non addirittura per comunicare informazioni di vario genere, dalla presenza di autovelox alla protesta per presunte violazioni del codice della strada.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Al di lá delle considerazioni e dei commenti circa queste abitudini, mi piacerebbe sapere se il verbo \u0026quot;sfanagliare\u0026quot; è normalmente usato, e compreso, in tutte le regioni italiane o se, magari, ci sono altri verbi in uso, purchè simpatici come quello.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Laddove qualcuno non avesse compreso l\u0027uso del aforementioned verbo, ecco un esempio:\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;\u0026quot;Ehi!\u0026quot; - dice il marito a sua moglie - \u0026quot;Quello li mi sta sfanagliando, st***o!\u0026quot;\u0026lt;/p\u0026gt;    \u0026lt;p\u0026gt;E la moglie, \u0026quot;Caro, rallenta; magari più avanti c\u0027è un autovelox, cribbio!\u0026quot;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\",\"puntos\":1,\"Fecha_de_creacion\":\"2013-11-10T19:44:53.797Z\",\"numVistas\":61,\"titulo\":\"Cosa sapreste dirmi della diffusione del verbo \u0026quot;sfanagliare\u0026quot; nelle diverse regioni italiane?\",\"tags\":\"\u0026lt;word-choice\u0026gt;\",\"nRespuestas\":1,\"tipoPost\":1,\"id\":1166}\n{\"nComs\":2,\"ultimaActividad\":\"2013-11-10T20:31:00.177Z\",\"userId\":17,\"cuerpo\":\"\u0026lt;p\u0026gt;Il verbo \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;sfanagliare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; è un verbo inventato, non esistente nella lingua italiana, ma questo penso fosse chiaro dalla domanda.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Personalmente non l\u0027ho mai sentito usare nel nord Italia, quindi non credo abbia una diffusione regionale omogenea. Un\u0027alternativa che mi è capitato invece di sentire  è \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;sfanalare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, con significato identico.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Ad ogni modo, non sono sicuro dell\u0027interpretazione di \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;sfanalare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;/\u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;sfanagliare\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; con il significato di \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;accecare con gli abbaglianti\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;. Probabilmente il significato che gli attribuirei è lo stesso di \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;fare i fari\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, ossia \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;segnalare qualcosa tramite i fari abbaglianti\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;, solitamente accendendoli e spegnedoli ripetutamente. Per esempio\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Non mi ero accorto che il semaforo fosse diventato verde e il tizio dietro mi ha fatto i fari\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;(ok l\u0027esempio è un po\u0027 tirato, sappiamo benissimo che il tizio di turno normalmente suona il clacson e tira una bestemmia...)\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;oppure\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Una vecchia consuetudine italiana era quella di sfanalare per segnalare la presenza della polizia stradale\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;Nell\u0027esempio che hai menzionato userei invece qualcosa del tipo\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Quello lì mi sta abbagliando (con sti c***o di fari, \u0026lt;em\u0026gt;ndt\u0026lt;/em\u0026gt;), st***o!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;or\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Quello lì mi sta accecando (con sti c***o di fari, \u0026lt;em\u0026gt;ndt\u0026lt;/em\u0026gt;), st***o!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\",\"puntos\":5,\"Fecha_de_creacion\":\"2013-11-10T19:58:02.100Z\",\"numVistas\":0,\"nRespuestas\":0,\"tipoPost\":2,\"id\":1167}\n{\"nComs\":1,\"ultimaActividad\":\"2014-07-25T13:15:02.270Z\",\"userId\":154,\"cuerpo\":\"\u0026lt;p\u0026gt;As part of my masters in linguistics, I am taking a course on the subject of irony. We were given examples of sentences that are most likely ironic, as the English sentence \u0026quot;he is not exceptionally smart\u0026quot; (which has the structure \u0026quot;he is not exceptionally X\u0026quot;). This does not mean literally that he is smart at an exceptional level, but rather, ironically, that he is very stupid.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Are there similar constructions in Italian, preferably ones that involve superlative and negation?\u0026lt;/p\u0026gt;\",\"puntos\":11,\"Fecha_de_creacion\":\"2013-11-10T22:03:41.027Z\",\"numVistas\":187,\"titulo\":\"Ironic constructions in Italian\",\"tags\":\"\u0026lt;english-comparison\u0026gt;\u0026lt;translation\u0026gt;\u0026lt;phrase-request\u0026gt;\",\"nRespuestas\":4,\"respAceptadaId\":1170,\"tipoPost\":1,\"id\":1168}\n{\"nComs\":0,\"ultimaActividad\":\"2013-11-10T22:15:17.693Z\",\"userId\":70,\"cuerpo\":\"\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Non è furbissimo\u0026lt;/em\u0026gt; can be used in the same sense as your example; or \u0026lt;em\u0026gt;non è velocissimo\u0026lt;/em\u0026gt; for someone who\u0027s rather slow. Maybe adding \u0026lt;em\u0026gt;proprio\u0026lt;/em\u0026gt;: \u0026lt;em\u0026gt;non è proprio furbissimo\u0026lt;/em\u0026gt;, which is more explicit in denying the smartness of the person.\u0026lt;/p\u0026gt;\",\"puntos\":3,\"Fecha_de_creacion\":\"2013-11-10T22:15:17.693Z\",\"numVistas\":0,\"nRespuestas\":0,\"tipoPost\":2,\"id\":1169}\n{\"nComs\":2,\"ultimaActividad\":\"2013-11-10T22:17:22.380Z\",\"userId\":17,\"cuerpo\":\"\u0026lt;p\u0026gt;There\u0027s plenty.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;On the same lines of the example you cited, here some examples\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Non proprio intelligentissimo\u0026lt;br\u0026gt;  Non esattamente una decisione geniale\u0026lt;br\u0026gt;  Un risultato non eccezionale\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;Or also\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Benone!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;which, depending on the tone, can be sarcastic or not.\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Bene ma non benissimo!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;is also a very typical ironic sentence, meaning neither \u0026lt;em\u0026gt;good\u0026lt;/em\u0026gt; nor \u0026lt;em\u0026gt;very good\u0026lt;/em\u0026gt;, but rather \u0026lt;em\u0026gt;pretty bad\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Generally speaking, whenever a litotes is used in conjunction with an hyperbole  it\u0027s a good hint that the sentence may be ironic.\u0026lt;/p\u0026gt;\",\"puntos\":8,\"Fecha_de_creacion\":\"2013-11-10T22:17:22.380Z\",\"numVistas\":0,\"nRespuestas\":0,\"tipoPost\":2,\"id\":1170}\n{\"nComs\":1,\"ultimaActividad\":\"2013-11-11T09:51:11.220Z\",\"userId\":63,\"cuerpo\":\"\u0026lt;p\u0026gt;As others already said, you could understand the sentence as starting with \u0026lt;em\u0026gt;si prega di\u0026lt;/em\u0026gt;, but truly the infinitive is used to express commands in Italian. That is true for sentences like \u0026lt;em\u0026gt;Ritirare lo scontrino alla cassa.\u0026lt;/em\u0026gt; or \u0026lt;em\u0026gt;Non ridere.\u0026lt;/em\u0026gt; which uses a negative and an implicit \u0026lt;em\u0026gt;tu\u0026lt;/em\u0026gt;; while the first is a command for everybody, the last is only for a single person.\u0026lt;/p\u0026gt;\u0026lt;h1\u0026gt;Reference\u0026lt;/h1\u0026gt;\u0026lt;ul\u0026gt;\u0026lt;li\u0026gt;\u0026lt;a href\u003d\u0026quot;http://tutorino.ca/grammatica/2007/10/26/uses-of-the-infinitive-in-italian.html\u0026quot; rel\u003d\u0026quot;nofollow\u0026quot;\u0026gt;Uses of the infinitive in Italian\u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt;\u0026lt;/ul\u0026gt;\",\"puntos\":3,\"Fecha_de_creacion\":\"2013-11-11T09:51:11.220Z\",\"numVistas\":0,\"nRespuestas\":0,\"tipoPost\":2,\"id\":1171}\n{\"nComs\":1,\"ultimaActividad\":\"2013-11-12T23:57:16.897Z\",\"userId\":63,\"cuerpo\":\"\u0026lt;p\u0026gt;The expression should be understood as \u0026lt;em\u0026gt;essere fuori di testa come un balcone è fuori dalla casa\u0026lt;/em\u0026gt;. In northern Italy, the expression would be understood by everybody; in other regions, the expression may not be understood, and the shorter \u0026lt;em\u0026gt;essere fuori di testa\u0026lt;/em\u0026gt; or \u0026lt;em\u0026gt;essere fuori di senno\u0026lt;/em\u0026gt; is the most used one. What probably makes the first sentence not clear to everybody is that \u0026lt;em\u0026gt;di testa\u0026lt;/em\u0026gt; is implicit.\u0026lt;/p\u0026gt;\",\"puntos\":1,\"Fecha_de_creacion\":\"2013-11-11T10:09:05.117Z\",\"numVistas\":0,\"nRespuestas\":0,\"tipoPost\":2,\"id\":1172}\n{\"nComs\":9,\"ultimaActividad\":\"2014-01-05T11:13:01.420Z\",\"userId\":63,\"cuerpo\":\"\u0026lt;p\u0026gt;When I was at the elementary schools, I was taught that \u0026lt;em\u0026gt;scancellare\u0026lt;/em\u0026gt; is not correct, and that I should always say \u0026lt;em\u0026gt;cancellare\u0026lt;/em\u0026gt;. When I grew up, I have heard that \u0026lt;em\u0026gt;scancellare\u0026lt;/em\u0026gt; is correct, and that the initial S is, someway, an intensifier.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;Is \u0026lt;em\u0026gt;scancellare\u0026lt;/em\u0026gt; really correct/acceptable? If it is not in standard Italian, is it acceptable in some contexts? For example, could be acceptable as regionalism?\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Lo Zingarelli 2013\u0026lt;/em\u0026gt; reports \u0026lt;em\u0026gt;scancellare\u0026lt;/em\u0026gt;, but it says it is \u0026lt;em\u0026gt;lett. pop.\u0026lt;/em\u0026gt; (I guess it means it is literary and popular.) The application I use on my Mac links \u0026lt;em\u0026gt;scancellare\u0026lt;/em\u0026gt; to \u0026lt;em\u0026gt;cancellare\u0026lt;/em\u0026gt;, which means that, looking for \u0026lt;em\u0026gt;scancellare\u0026lt;/em\u0026gt;, I get the description for \u0026lt;em\u0026gt;cancellare\u0026lt;/em\u0026gt; with just a small reference to \u0026lt;em\u0026gt;scancellare\u0026lt;/em\u0026gt;.  \u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;\u0026lt;img src\u003d\u0026quot;http://i.stack.imgur.com/XWBpL.png\u0026quot; alt\u003d\u0026quot;screenshot\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;What I am asking is if it is a word I could use in a formal context, during school tests, or similar contexts.\u0026lt;/p\u0026gt;\",\"puntos\":5,\"Fecha_de_creacion\":\"2013-11-11T10:28:12.613Z\",\"numVistas\":122,\"titulo\":\"Is \u0026quot;scancellare\u0026quot; really not correct?\",\"tags\":\"\u0026lt;usage\u0026gt;\u0026lt;verbs\u0026gt;\",\"nRespuestas\":3,\"respAceptadaId\":1181,\"tipoPost\":1,\"id\":1173}\n{\"nComs\":0,\"ultimaActividad\":\"2013-11-11T10:58:02.620Z\",\"userId\":18,\"cuerpo\":\"\u0026lt;p\u0026gt;Wow, what an overloaded word! It has \u0026lt;strong\u0026gt;six\u0026lt;/strong\u0026gt; different meanings or usages I can find.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;As an adverb it may mean \u0026lt;em\u0026gt;maybe\u0026lt;/em\u0026gt; (\u0026lt;em\u0026gt;cf. \u0026amp;ldquo;forse\u0026amp;rdquo;\u0026lt;/em\u0026gt;)\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;A: Ci vediamo?\u0026lt;/p\u0026gt;    \u0026lt;p\u0026gt;B: Magari s\u0026amp;igrave;.\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;but it can also mean \u0026lt;em\u0026gt;even\u0026lt;/em\u0026gt; (\u0026lt;em\u0026gt;cf. \u0026amp;ldquo;persino\u0026amp;rdquo;\u0026lt;/em\u0026gt;)\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;A: Ci vediamo?\u0026lt;/p\u0026gt;    \u0026lt;p\u0026gt;B: Vengo assolutamente, magari a piedi!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;As a conjunction it can similarly mean \u0026lt;em\u0026gt;even if\u0026lt;/em\u0026gt; (\u0026lt;em\u0026gt;cf. \u0026amp;ldquo;persino se\u0026amp;rdquo;\u0026lt;/em\u0026gt;)\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Lo aspetterò, magari dovessi restare qui tutta la notte.\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;or, \u0026lt;em\u0026gt;if only\u0026lt;/em\u0026gt; (\u0026lt;em\u0026gt;cf. \u0026amp;ldquo;se solamente\u0026amp;rdquo;\u0026lt;/em\u0026gt;)\u0026lt;/p\u0026gt;\u0026lt;blockquote\u0026gt;  \u0026lt;p\u0026gt;Eravamo soli, magari fossi venuto!\u0026lt;/p\u0026gt;\u0026lt;/blockquote\u0026gt;\u0026lt;p\u0026gt;As an interjection it can either mean \u0026lt;em\u0026gt;I can only wish\u0026amp;hellip;\u0026lt;/em\u0026gt;, but also \u0026lt;em\u0026gt;I really want to!\u0026lt;/em\u0026gt; depending on context and/or emphasis.\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;The word comes from the  Greek μακάρι (makári), which is derived from μακάριος (makários), according to \u0026lt;a href\u003d\u0026quot;http://www.etimo.it/?term\u003dmagari\u0026quot;\u0026gt;etimo.it\u0026lt;/a\u0026gt; and it can be loosely translated as \u0026lt;em\u0026gt;\u0026amp;ldquo;God(s) willing!\u0026amp;rdquo;\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;h3\u0026gt;References\u0026lt;/h3\u0026gt;\u0026lt;ul\u0026gt;\u0026lt;li\u0026gt;\u0026lt;a href\u003d\u0026quot;https://en.wiktionary.org/wiki/magari\u0026quot;\u0026gt;https://en.wiktionary.org/wiki/magari\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026lt;a href\u003d\u0026quot;http://dizionari.corriere.it/dizionario_italiano/M/magari.shtml\u0026quot;\u0026gt;http://dizionari.corriere.it/dizionario_italiano/M/magari.shtml\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026lt;a href\u003d\u0026quot;http://it.thefreedictionary.com/magari\u0026quot;\u0026gt;http://it.thefreedictionary.com/magari\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026lt;a href\u003d\u0026quot;http://www.etimo.it/?term\u003dmagari\u0026quot;\u0026gt;http://www.etimo.it/?term\u003dmagari\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026lt;/ul\u0026gt;\",\"puntos\":5,\"Fecha_de_creacion\":\"2013-11-11T10:58:02.620Z\",\"numVistas\":0,\"nRespuestas\":0,\"tipoPost\":2,\"id\":1174}\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541578870065_140307197",
      "id": "20181107-082110_164297783",
      "dateCreated": "2018-11-07 08:21:10.000",
      "dateStarted": "2020-11-18 15:26:18.380",
      "dateFinished": "2020-11-18 15:26:18.410",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Guardo el DataFrame  usando Parquet\ndfSE.write.format(\"parquet\")\\\n    .mode(\"overwrite\")\\\n    .save(\"/datos/dfSE.parquet\")",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:26:55.490",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1541579158874_-2091049375",
      "id": "20181107-082558_880282400",
      "dateCreated": "2018-11-07 08:25:58.000",
      "dateStarted": "2020-11-18 15:26:55.551",
      "dateFinished": "2020-11-18 15:26:56.217",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nprint(dfSE.rdd.getNumPartitions())",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:28:31.595",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1605713293666_-18294125",
      "id": "20201118-152813_622541168",
      "dateCreated": "2020-11-18 15:28:13.666",
      "dateStarted": "2020-11-18 15:28:31.646",
      "dateFinished": "2020-11-18 15:28:31.740",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n# Parquet usa por defecto formato comprimido snappy\nls -lh /datos/dfSE.parquet",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:26:59.350",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total 616K\n-rw-r--r-- 1 root root 614K Nov 18 15:26 part-00000-3da3895d-5912-4552-b092-b73bf6195efb-c000.snappy.parquet\n-rw-r--r-- 1 root root    0 Nov 18 15:26 _SUCCESS\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541579208386_1334049657",
      "id": "20181107-082648_1663222519",
      "dateCreated": "2018-11-07 08:26:48.000",
      "dateStarted": "2020-11-18 15:26:59.411",
      "dateFinished": "2020-11-18 15:26:59.427",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nSe crean tantos ficheros como particiones tenga el DataFrame",
      "user": "anonymous",
      "dateUpdated": "2019-10-30 10:00:09.000",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eSe crean tantos ficheros como particiones tenga el DataFrame\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541578809096_-969136269",
      "id": "20181107-082009_674014989",
      "dateCreated": "2018-11-07 08:20:09.000",
      "dateStarted": "2019-10-30 10:00:11.000",
      "dateFinished": "2019-10-30 10:00:11.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndfSE2 \u003d dfSE.repartition(2)\n# Guardo el DataFrame  usando Parquet, con compresión gzip\ndfSE2.write.format(\"parquet\")\\\n     .mode(\"overwrite\")\\\n     .option(\"compression\", \"gzip\")\\\n     .save(\"/datos/dfSE2.parquet\")",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:28:58.084",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1539193317972_1763464743",
      "id": "20181010-174157_752709636",
      "dateCreated": "2018-10-10 17:41:57.000",
      "dateStarted": "2020-11-18 15:28:58.139",
      "dateFinished": "2020-11-18 15:28:58.439",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\nls -lh /datos/dfSE2.parquet",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:29:03.066",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total 412K\n-rw-r--r-- 1 root root 197K Nov 18 15:28 part-00000-9ec50216-c145-4be0-9208-08c0012cb68d-c000.gz.parquet\n-rw-r--r-- 1 root root 209K Nov 18 15:28 part-00001-9ec50216-c145-4be0-9208-08c0012cb68d-c000.gz.parquet\n-rw-r--r-- 1 root root    0 Nov 18 15:28 _SUCCESS\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1539193485560_1892920358",
      "id": "20181010-174445_1940888646",
      "dateCreated": "2018-10-10 17:44:45.000",
      "dateStarted": "2020-11-18 15:29:03.127",
      "dateFinished": "2020-11-18 15:29:03.150",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n#### Particionado\nPermite particionar los ficheros guardados por el valor de una columna\n\n- Se crea un directorio por cada valor diferente en la columna de particionado\n    - Todos los datos asociados a ese valor se guardan en ese directorio\n- Permite simplificar el acceso a los valores asociados a una clave\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-10 20:03:08.669",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eParticionado\u003c/h4\u003e\n\u003cp\u003ePermite particionar los ficheros guardados por el valor de una columna\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eSe crea un directorio por cada valor diferente en la columna de particionado\n    \u003cul\u003e\n      \u003cli\u003eTodos los datos asociados a ese valor se guardan en ese directorio\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003ePermite simplificar el acceso a los valores asociados a una clave\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541578981042_494155899",
      "id": "20181107-082301_1547492048",
      "dateCreated": "2018-11-07 08:23:01.000",
      "dateStarted": "2020-06-10 20:03:08.670",
      "dateFinished": "2020-06-10 20:03:08.724",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Guardo el DataFrame particionado por el userId (usando Parquet)\ndfSE.write.format(\"parquet\")\\\n    .mode(\"overwrite\")\\\n    .partitionBy(\"userId\")\\\n    .save(\"/datos/dfSE-particionado.parquet\")",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:30:24.361",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1541581505723_413282733",
      "id": "20181107-090505_1564750411",
      "dateCreated": "2018-11-07 09:05:05.000",
      "dateStarted": "2020-11-18 15:30:24.417",
      "dateFinished": "2020-11-18 15:30:26.862",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\nls /datos/dfSE-particionado.parquet\nls -lh /datos/dfSE-particionado.parquet/userId\u003d10\nrm -rf /datos/dfSE-particionado.parquet",
      "user": "anonymous",
      "dateUpdated": "2020-11-18 15:30:31.910",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "_SUCCESS\nuserId\u003d10\nuserId\u003d103\nuserId\u003d114\nuserId\u003d116\nuserId\u003d119\nuserId\u003d12\nuserId\u003d120\nuserId\u003d121\nuserId\u003d124\nuserId\u003d129\nuserId\u003d13\nuserId\u003d132\nuserId\u003d133\nuserId\u003d134\nuserId\u003d135\nuserId\u003d139\nuserId\u003d14\nuserId\u003d145\nuserId\u003d15\nuserId\u003d154\nuserId\u003d158\nuserId\u003d159\nuserId\u003d17\nuserId\u003d176\nuserId\u003d178\nuserId\u003d179\nuserId\u003d18\nuserId\u003d189\nuserId\u003d19\nuserId\u003d190\nuserId\u003d193\nuserId\u003d198\nuserId\u003d199\nuserId\u003d202\nuserId\u003d204\nuserId\u003d212\nuserId\u003d213\nuserId\u003d217\nuserId\u003d218\nuserId\u003d219\nuserId\u003d22\nuserId\u003d220\nuserId\u003d223\nuserId\u003d224\nuserId\u003d227\nuserId\u003d228\nuserId\u003d229\nuserId\u003d230\nuserId\u003d232\nuserId\u003d234\nuserId\u003d235\nuserId\u003d250\nuserId\u003d259\nuserId\u003d270\nuserId\u003d279\nuserId\u003d280\nuserId\u003d281\nuserId\u003d283\nuserId\u003d291\nuserId\u003d292\nuserId\u003d295\nuserId\u003d300\nuserId\u003d307\nuserId\u003d310\nuserId\u003d320\nuserId\u003d323\nuserId\u003d324\nuserId\u003d334\nuserId\u003d338\nuserId\u003d340\nuserId\u003d341\nuserId\u003d348\nuserId\u003d351\nuserId\u003d358\nuserId\u003d360\nuserId\u003d37\nuserId\u003d373\nuserId\u003d374\nuserId\u003d375\nuserId\u003d377\nuserId\u003d380\nuserId\u003d388\nuserId\u003d391\nuserId\u003d393\nuserId\u003d4\nuserId\u003d407\nuserId\u003d41\nuserId\u003d413\nuserId\u003d415\nuserId\u003d421\nuserId\u003d424\nuserId\u003d425\nuserId\u003d431\nuserId\u003d435\nuserId\u003d437\nuserId\u003d438\nuserId\u003d440\nuserId\u003d445\nuserId\u003d448\nuserId\u003d456\nuserId\u003d465\nuserId\u003d466\nuserId\u003d48\nuserId\u003d483\nuserId\u003d489\nuserId\u003d490\nuserId\u003d492\nuserId\u003d497\nuserId\u003d5\nuserId\u003d501\nuserId\u003d504\nuserId\u003d509\nuserId\u003d516\nuserId\u003d519\nuserId\u003d521\nuserId\u003d523\nuserId\u003d525\nuserId\u003d527\nuserId\u003d53\nuserId\u003d535\nuserId\u003d545\nuserId\u003d546\nuserId\u003d553\nuserId\u003d559\nuserId\u003d56\nuserId\u003d567\nuserId\u003d569\nuserId\u003d57\nuserId\u003d570\nuserId\u003d572\nuserId\u003d580\nuserId\u003d581\nuserId\u003d585\nuserId\u003d589\nuserId\u003d590\nuserId\u003d591\nuserId\u003d598\nuserId\u003d599\nuserId\u003d6\nuserId\u003d606\nuserId\u003d608\nuserId\u003d61\nuserId\u003d614\nuserId\u003d623\nuserId\u003d624\nuserId\u003d626\nuserId\u003d63\nuserId\u003d633\nuserId\u003d634\nuserId\u003d645\nuserId\u003d656\nuserId\u003d659\nuserId\u003d662\nuserId\u003d663\nuserId\u003d672\nuserId\u003d674\nuserId\u003d676\nuserId\u003d677\nuserId\u003d679\nuserId\u003d68\nuserId\u003d683\nuserId\u003d685\nuserId\u003d70\nuserId\u003d703\nuserId\u003d707\nuserId\u003d71\nuserId\u003d714\nuserId\u003d720\nuserId\u003d725\nuserId\u003d729\nuserId\u003d73\nuserId\u003d730\nuserId\u003d736\nuserId\u003d739\nuserId\u003d741\nuserId\u003d744\nuserId\u003d746\nuserId\u003d749\nuserId\u003d75\nuserId\u003d751\nuserId\u003d764\nuserId\u003d765\nuserId\u003d768\nuserId\u003d77\nuserId\u003d776\nuserId\u003d779\nuserId\u003d785\nuserId\u003d79\nuserId\u003d794\nuserId\u003d796\nuserId\u003d797\nuserId\u003d799\nuserId\u003d8\nuserId\u003d801\nuserId\u003d803\nuserId\u003d804\nuserId\u003d805\nuserId\u003d806\nuserId\u003d808\nuserId\u003d809\nuserId\u003d812\nuserId\u003d813\nuserId\u003d814\nuserId\u003d82\nuserId\u003d833\nuserId\u003d835\nuserId\u003d842\nuserId\u003d845\nuserId\u003d846\nuserId\u003d85\nuserId\u003d855\nuserId\u003d862\nuserId\u003d87\nuserId\u003d88\nuserId\u003d91\nuserId\u003d95\nuserId\u003d98\nuserId\u003d99\ntotal 4.0K\n-rw-r--r-- 1 root root 3.7K Nov 18 15:30 part-00000-a5ebabc9-e5a9-4a1c-8101-c26800ccde13.c000.snappy.parquet\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1541581569478_726183741",
      "id": "20181107-090609_1437902224",
      "dateCreated": "2018-11-07 09:06:09.000",
      "dateStarted": "2020-11-18 15:30:31.981",
      "dateFinished": "2020-11-18 15:30:32.030",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark",
      "user": "anonymous",
      "dateUpdated": "2020-11-05 16:54:16.246",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionSupport": true,
          "completionKey": "TAB"
        },
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1545151919369_-1529274948",
      "id": "20181218-165159_86970687",
      "dateCreated": "2018-12-18 16:51:59.000",
      "dateStarted": "2020-11-05 16:53:56.553",
      "dateFinished": "2020-11-05 16:53:56.596",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2020-11-05 16:53:56.410",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1604595236409_486802641",
      "id": "20201105-165356_784204246",
      "dateCreated": "2020-11-05 16:53:56.409",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Apache Spark/03 - Trabajando con DataFrames",
  "id": "2DSQVAZGE",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "sh:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}